import{a as N,l as O,u as j,G as k,f as c,j as a,T as s,H as G,L as T,I as E,c as i,s as u,J as w,F as y,K as M,M as K,N as P,O as r}from"./index-5904d5c1.js";import{R as A}from"./Responser-fdda9d80.js";const W=()=>{const t=N(),l=O(),g=j(e=>e.user),d=j(e=>e.app),m=k().pathname,[p,h]=c.useState(""),[f,x]=c.useState(""),[C,o]=c.useState("");function b(e){h(e.target.value)}function v(e){x(e.target.value)}async function L(){o(s.loading+"...");const e=await E({login:p,pword:f});if(e.status==="WRONG")return o(s.wrongAuth);if(e.status==="OK")return i(t),u(t,{message:s.greetings+", "+e.data.name,status:"complete",title:null}),o(""),await w(t),l.push("/"),y(t,e.data);o(s.errorReg+", "+s.errCode+": "+(e.msg||e))}async function R(){const e=await M();if(e.status==="OK")return u(t,{message:s.farewell+", "+g.name,status:"complete",title:null}),h(""),x(""),o(""),K(t);o(s.errorReg+", "+s.errCode+": "+(e.msg||e))}async function S(e){const n=await P(e.credential);if(n.status==="FIRSTTIME")return B(n),i(t),l.push("/googleConfirm");if(n.status==="OK")return i(t),u(t,{message:s.greetings+", "+n.data.name,status:"complete",title:null}),o(""),await w(t),l.push("/"),y(t,n.data);o(s.errorReg+", "+s.errCode+": "+(n.msg||n))}function F(e){console.log("%câ§­ google auth failed","color: #00a3cc",e),o(s.errorReg+", "+s.errCode+": "+JSON.stringify(e))}function I(){i(t)}return a.jsx("div",{children:d.isLogged?a.jsxs("div",{children:[a.jsxs("h4",{children:[s.greetings,", ",g.name]}),a.jsx("button",{className:"primary",onClick:R,children:s.logout})]}):a.jsxs("div",{children:[a.jsxs("div",{className:m!=="/auth"?"login-form login-form-bordered mp-border-secondary":"login-form",children:[a.jsxs("label",{htmlFor:"name",children:[s.yourLogin,":"]}),a.jsx("input",{type:"text",name:"login",value:p,onInput:b,autoFocus:!0}),a.jsx("br",{}),a.jsxs("label",{htmlFor:"pword",children:[s.yourPword,":"]}),a.jsx("input",{type:"password",name:"pword",value:f,onInput:v}),a.jsx(A,{message:C,setMessage:o}),a.jsx("button",{className:"primary mp-border-accent loginBtn",onClick:L,children:s.confirm}),a.jsx(G,{shape:"rectangular",onSuccess:S,onError:F,width:"200",theme:d.theme==="dark"?"filled_black":"outline"})]}),m!=="/auth"&&a.jsx("div",{className:"align-center",children:a.jsx(T,{to:"/auth?reg=true",onClick:I,children:a.jsx("button",{className:"button",children:s.register})})})]})})};function B(t){r.name=t.data.name,r.login=t.data.login,t.data.login||(r.occupiedLogin=t.data.email),r.avatar=t.data.avatar,r.id=t.data.id}export{W as Login};
