import{a as k,B as F,u as j,i as N,r as c,j as s,T as t,G as E,L as T,D as A,c as i,s as u,E as w,C as y,F as G,H as M,I as K,J as r}from"./index-c4876c4f.js";import{R as P}from"./Responser-345828b1.js";const H=()=>{const a=k(),l=F(),g=j(e=>e.user),d=j(e=>e.app),m=N().pathname,[p,h]=c.useState(""),[f,x]=c.useState(""),[b,n]=c.useState("");function v(e){h(e.target.value)}function C(e){x(e.target.value)}async function R(){n(t.loading+"...");const e=await A({login:p,pword:f});if(e.status==="WRONG")return n(t.wrongAuth);if(e.status==="OK")return i(a),u(a,{message:t.greetings+", "+e.data.name,status:"complete",title:null}),n(""),await w(a),l.push("/"),y(a,e.data);n(t.errorReg+", "+t.errCode+": "+(e.msg||e))}async function L(){const e=await G();if(e.status==="OK")return u(a,{message:t.farewell+", "+g.name,status:"complete",title:null}),h(""),x(""),n(""),M(a);n(t.errorReg+", "+t.errCode+": "+(e.msg||e))}async function O(e){const o=await K(e.credential);if(o.status==="FIRSTTIME")return r.token=e.credential,r.name=o.data.name,r.login=o.data.login,o.data.login||(r.occupiedLogin=o.data.email),r.avatar=o.data.avatar,r.id=o.data.id,i(a),l.push("/googleConfirm");if(o.status==="OK")return i(a),u(a,{message:t.greetings+", "+o.data.name,status:"complete",title:null}),n(""),await w(a),l.push("/"),y(a,o.data);n(t.errorReg+", "+t.errCode+": "+(o.msg||o))}function I(e){console.log("%câ§­ failed","color: #00a3cc",e),n(t.errorReg+", "+t.errCode+": "+JSON.stringify(e))}function S(){i(a)}return s.jsx("div",{children:d.isLogged?s.jsxs("div",{children:[s.jsxs("h4",{children:[t.greetings,", ",g.name]}),s.jsx("button",{className:"primary",onClick:L,children:t.logout})]}):s.jsxs("div",{children:[s.jsxs("div",{className:m!=="/auth"?"login-form login-form-bordered mp-border-secondary":"login-form",children:[s.jsxs("label",{htmlFor:"name",children:[t.yourLogin,":"]}),s.jsx("input",{type:"text",name:"login",value:p,onInput:v,autoFocus:!0}),s.jsx("br",{}),s.jsxs("label",{htmlFor:"pword",children:[t.yourPword,":"]}),s.jsx("input",{type:"password",name:"pword",value:f,onInput:C}),s.jsx(P,{message:b,setMessage:n}),s.jsx("button",{className:"primary mp-border-accent loginBtn",onClick:R,children:t.confirm}),s.jsx(E,{shape:"rectangular",onSuccess:O,onError:I,width:"200",theme:d.theme==="dark"?"filled_black":"outline"})]}),m!=="/auth"&&s.jsx("div",{className:"align-center",children:s.jsx(T,{to:"/auth?reg=true",onClick:S,children:s.jsx("button",{className:"button",children:t.register})})})]})})};export{H as Login};
