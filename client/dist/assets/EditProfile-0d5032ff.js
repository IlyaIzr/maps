import{a as b,u as C,B as v,r as d,h as y,j as e,T as s,C as g,F as N,s as q,H as F}from"./index-c4876c4f.js";import{u as O,a as E}from"./users-c3680902.js";import{R as L}from"./Responser-345828b1.js";const p={login:"",pword:"",name:"",question:"",answer:""},A=()=>{const l=b(),n=C(a=>a.user),x=v(),[t,i]=d.useState(p),[m,f]=d.useState(!1),[h,r]=d.useState("");d.useEffect(()=>(n.id&&i(a=>({...a,name:n.name,login:n.login,avatar:n.avatar})),()=>{i(p)}),[n]),d.useEffect(()=>{y(l)},[]);function u(a){i({...t,[a.target.name]:a.target.value})}async function j(a){if(a.preventDefault(),!t.login||!t.name)return r(s.fillRequiredFields);if(t.login.length>50)return r((s.field+" "+s.login+" "+s.tooLong).toLocaleLowerCase().capitalize());if(t.pword.length>50)return r((s.field+" "+s.password+" "+s.tooLong).toLocaleLowerCase().capitalize());if(t.name.length>140)return r((s.field+" "+s.userName+" "+s.tooLong).toLocaleLowerCase().capitalize());if(m){const c=await O(t);return c.status==="OK"?(r(s.successfulUpdate),f(!1),g(l,c.data)):c.status==="BANEDPWORD"?r(s.bannedPwod+" - "+t.pword):r(s.errCode+": "+(c.msg||c))}const o=await E(t);if(console.log("%câ§­","color: #514080",o),o.status==="OK")return r(s.successfulUpdate),g(l,o.data);if(o.status==="EXISTING")return r(s.loginOccupied+" - "+t.login);if(o.status==="PWORDCHANGE")return f(!0),i({...t,question:o.data.question}),r(s.secretChallenge);r(s.errCode+": "+(o.msg||o))}async function w(){const a=await N();if(a.status==="OK")return i(p),r(""),q(l,{message:s.farewell+", "+n.name,status:"complete",title:""}),F(l),x.push("/");r(s.errCode+": "+(a.msg||a))}return e.jsx("div",{className:"edit-profile-area relative ",children:e.jsxs("div",{className:"edit-profile-wrapper absolute center mp-border-secondary",children:[e.jsxs("form",{className:"edit-profile ",children:[e.jsx("h4",{children:s.editProfile}),e.jsxs("label",{htmlFor:"login",children:[s.login,":"]}),e.jsx("input",{type:"text",name:"login",value:t.login,onInput:u,autoFocus:!0,required:!0}),e.jsx("br",{}),e.jsxs("label",{htmlFor:"name",children:[s.userName,":"]}),e.jsx("input",{type:"text",name:"name",value:t.name,onInput:u,autoFocus:!0,required:!0}),e.jsx("br",{}),e.jsxs("label",{htmlFor:"pword",children:[s.newPassword,":"]}),e.jsx("input",{type:"password",name:"pword",value:t.pword,onInput:u}),e.jsx("br",{}),e.jsx("br",{}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{htmlFor:"question",children:[s.secretQuestion,":"]}),e.jsx("br",{}),e.jsx("textarea",{type:"text",name:"question",value:t.question,onInput:u,autoComplete:"false",readOnly:!0}),e.jsx("br",{}),e.jsxs("label",{htmlFor:"answer",children:[s.secterAnswer,":"]}),e.jsx("input",{type:"text",name:"answer",value:t.answer,onInput:u,required:!!t.question,autoComplete:"false"}),e.jsx("br",{})]}),e.jsx(L,{message:h,setMessage:r})]}),e.jsx("hr",{className:"mp-border-secondary"}),e.jsxs("div",{className:"logout-container",children:[e.jsx("button",{className:"mp-border-secondary profile-logout",onClick:w,children:s.logout}),e.jsx("button",{className:"mp-border-accent",onClick:j,children:s.submit})]})]})})};export{A as EditProfile};
