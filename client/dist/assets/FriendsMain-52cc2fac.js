import{B as L,u as y,j as e,T as a,L as f,J as C,a as b,r as d,K as E,s as h,M as w,E as g,N as F,O as R,i as S,P as U,h as P,S as q,R as j}from"./index-a80ce244.js";import{S as O}from"./Friends-26d1d572.js";import"./tags-4b342e18.js";const I=window.location.origin+"/friends/addByLink?id=",K=()=>{const r=L(),{id:t,friends:c,requests:s}=y(n=>n.user);function i(n){r.push(`/friends/item/${n}`)}function u(n){n.target.select()}return e.jsxs("div",{className:"friendsDefault",children:[e.jsx("h4",{children:a.friendList}),e.jsx("div",{className:"friendList",children:c!=null&&c.length?c.map(n=>{var m,l;return e.jsx("div",{className:"friendContainer",children:e.jsxs("div",{className:"resultUser cursor-pointer mp-accent-hover transition-small",onClick:()=>i(n.id),children:[e.jsx("div",{className:"authorLogo mp-bg-primary",children:e.jsx("span",{className:"mp-dark",title:n.login,children:(l=(m=String(n.name))==null?void 0:m[0])==null?void 0:l.toUpperCase()})}),e.jsxs("div",{className:"resultUser-creds",children:[e.jsx("p",{className:"mp-primary",children:n.name}),e.jsxs("label",{className:"cursor-pointer",children:["(",n.login,")"]})]})]},n.id)},n.id1+n.id2)}):e.jsx("div",{className:"noFriendsCase",children:e.jsx("h5",{children:a.sadlyNoFriends})})}),e.jsx("h4",{children:!!(s!=null&&s.length)&&a.friendRequests}),!!(s!=null&&s.length)&&e.jsx("div",{className:"friendList",children:!!(s!=null&&s.length)&&s.map(n=>{var m,l;return e.jsx("div",{className:"friendContainer",children:e.jsxs("div",{className:"resultUser cursor-pointer mp-accent-hover transition-small",onClick:()=>i(n.id),children:[e.jsx("div",{className:"authorLogo mp-bg-primary",children:e.jsx("span",{className:"mp-dark",title:n.login,children:(l=(m=String(n.name))==null?void 0:m[0])==null?void 0:l.toUpperCase()})}),e.jsxs("div",{className:"resultUser-creds",children:[e.jsx("p",{className:"mp-primary",children:n.name}),e.jsxs("label",{className:"cursor-pointer",children:["(",n.login,")"]})]})]},n.id)},n.id1+n.id2)})}),e.jsxs("div",{className:"addMeLink",children:[e.jsx("h4",{children:a.addMeLink}),e.jsx("input",{type:"text",value:I+t,onFocus:u,readOnly:!0})]}),e.jsx(f,{to:"/friends/addByLink",children:e.jsx("button",{className:"button",children:a.addByLink})})]})},B=({loading:r})=>r?e.jsx("div",{children:"Loading anmation..."}):null,T=()=>{const{userId:r}=C(),t=b(),c=y(o=>o.user),[s,i]=d.useState(null),[u,n]=d.useState(!0),[m,l]=d.useState(e.jsx("button",{className:"button",onClick:x,children:a.addFriend}));if(d.useEffect(()=>{(async function(){if(c.id===r)return i({...c}),l(e.jsx(f,{to:"/editProfile",children:e.jsx("button",{className:"button",children:a.profile})})),n(!1);const o=await E(r);o.status!=="OK"?h(t,{message:a.requestError+" #profEr1"}):i(o.data),n(!1)})()},[r]),d.useEffect(()=>{s!=null&&s.friendStatus&&(s.friendStatus==="friends"?l(e.jsxs("div",{children:[e.jsx(f,{to:"/friends",children:e.jsx("button",{className:"button",children:a.inFriendlist})}),e.jsx("button",{className:"button mp-border-counter",onClick:N,children:a.removeFriend})]})):s.friendStatus==="youRequested"?l(e.jsx("button",{className:"button mp-border-secondary mp-secondary",children:a.youRequested})):s.friendStatus==="youAsked"&&l(e.jsx("button",{className:"button mp-border-accent",onClick:v,children:a.confirmRequest})))},[s==null?void 0:s.friendStatus]),u)return e.jsx("div",{className:"profileContainer",children:e.jsx(B,{loading:u})});async function x(){if((await w(r)).status!=="OK")return h(t,{message:a.requestError+" #profEr2"});await g(t),l(e.jsx("button",{className:"button",children:a.sent}))}async function N(){if((await F(r)).status!=="OK")return h(t,{message:a.requestError+" #profEr3"});await g(t),i({...s,friendStatus:"youAsked"})}async function v(){if((await R(r)).status!=="OK")return h(t,{message:a.requestError+" #profEr4"});await g(t),i({...s,friendStatus:"friends"})}return s?e.jsxs("div",{className:"profileContainer",children:[e.jsxs("div",{className:"userProfile mp-border-dark",children:[!!s.avatar&&e.jsx("div",{className:"avatar",children:e.jsx("img",{src:s.avatar,alt:a.avatar})}),e.jsxs("div",{className:"mp-primary credentials ",title:a.userName,children:[s.name," ",e.jsxs("label",{className:"mp-dark",title:a.login,children:["(",s.login,")"]})]}),!!s.commentsn&&e.jsxs("div",{className:"commentsn",children:[a.commentsn,": ",s.commentsn]}),e.jsxs("div",{className:"level capitalize",children:[a.level,": ",e.jsx("label",{className:"mp-dark",children:s.level})]})]}),e.jsx("div",{className:"friends-actionButton",children:m})]}):e.jsx("div",{className:"profileContainer",children:e.jsx("div",{className:"userProfile mp-border-dark",children:e.jsx("p",{children:a.noResults})})})},D=({searchResults:r})=>{const t=new URLSearchParams(S().search).get("query"),c=L();if(!r)return null;if(!r.length)return e.jsx("div",{className:"resultsContainer",children:e.jsx("h5",{children:a.noResults})});function s(i){c.push(`/friends/item/${i}?from=${t}`)}return e.jsx("div",{className:"resultsContainer",children:r.map(i=>{var u,n;return e.jsxs("div",{className:"resultUser cursor-pointer mp-accent-hover transition-small",onClick:()=>s(i.id),children:[e.jsx("div",{className:"authorLogo mp-bg-primary",children:e.jsx("span",{className:"mp-dark",title:i.login,children:(n=(u=String(i.name))==null?void 0:u[0])==null?void 0:n.toUpperCase()})}),e.jsxs("div",{className:"resultUser-creds",children:[e.jsx("p",{className:"mp-primary",children:i.name}),e.jsxs("label",{className:"cursor-pointer",children:["(",i.login,")"]})]})]},i.id)})})},M=()=>{const r=new URLSearchParams(S().search).get("id"),t=b(),[c,s]=d.useState(null),[i,u]=d.useState(!0),[n,m]=d.useState("");function l(o){const p=o.target.value;if(m(p),p!=null&&p.includes("id")){const k=new URLSearchParams(p.split("?")[1]);k.get("id")&&s(k.get("id"))}}const[x,N]=d.useState(!1);d.useEffect(()=>{r&&s(r)},[]),d.useEffect(()=>{(async function(){c&&(console.log("%c⧭ id run","color: #733d00",c),await v(),u(!1))})()},[c]);async function v(){const o=await U(c);if(console.log("%c⧭","color: #00e600",o),o.status!=="OK")return h(t,{message:a.requestError+" #adBLi1"});h(t,{message:a.yourFriendsNow,status:"complete"}),N(!0)}return r&&i?e.jsx(B,{loading:i}):e.jsxs("div",{className:"addByLink",children:[e.jsx("h4",{children:a.addByLink}),x?e.jsx("div",{children:e.jsx(f,{to:"/friends",children:e.jsx("button",{className:"button",children:a.goBack})})}):e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"link",children:a.pasteAddLink}),e.jsx("input",{type:"text",value:n,onInput:l,readOnly:x})]})]})},H=()=>{const r=b(),t=y(i=>i.app),[c,s]=d.useState(null);return d.useEffect(()=>{P(r)},[]),t.isLogged?e.jsxs("div",{children:[e.jsx(O,{setSearchResults:s}),e.jsxs(q,{children:[e.jsx(j,{exact:!0,path:"/friends",children:e.jsx(K,{})}),e.jsx(j,{path:"/friends/item/:userId",children:e.jsx(T,{})}),e.jsx(j,{path:"/friends/search",children:e.jsx(D,{searchResults:c})}),e.jsx(j,{path:"/friends/addByLink",children:e.jsx(M,{})})]}),e.jsx("div",{className:"bottom"})]}):e.jsx("div",{className:"friendsNotLoggedWrap auth-container relative",children:e.jsx("div",{className:"absolute center auth-subcontainer",children:e.jsxs("div",{className:"auth-action-wrap mp-border-secondary",children:[e.jsx("p",{children:a.loginToUseThis}),e.jsx(f,{to:"/auth",children:e.jsx("button",{className:"primary mp-border-accent loginBtn capitalize",children:a.authorization})})]})})})};export{H as FriendsMain};
