import{p as i,v as w,u as b,l as D,j as n,O,r as k,T as G}from"./index-fe52dfb8.js";import{S as $}from"./SearchBar-0f03556f.js";import{c as z,m as A,b as F,T as M}from"./TotalRating-bd20ab1c.js";import{g as q}from"./helperFuncs-de5b9e47.js";import"./tags-20cff19d.js";const B="_cityItem_4nrjv_1",U="_geojsonPreview_4nrjv_10",H="_cityDetails_4nrjv_18",L="_cityName_4nrjv_22",V="_cityRating_4nrjv_30",l={cityItem:B,geojsonPreview:U,cityDetails:H,cityName:L,cityRating:V};function h(c){var t=[1/0,1/0,-1/0,-1/0];return z(c,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}h.default=h;const X=({amount:c,rating:t,en:e,ru:f,lat:o,lng:u,geometry:d})=>{const m=i.useRef(null),[y,v]=i.useState(null),x=w(),_=b(s=>s.app.mapRef),C=i.useCallback(()=>{const s=p;console.log("%câ§­","color: #e50000",{lat:o,lng:u}),D({lat:o,lng:u,zoom:s}),x.push(`/?lat=${o}&lng=${u}&zoom=${s}`),_.flyTo({center:[u,o],zoom:s,speed:.8})},[p]);return i.useEffect(()=>{if(d){const s=A(q(d));v(s)}},[d]),i.useEffect(()=>{if(y&&m.current){const s=m.current,a=s.getContext("2d");if(a){const r=h(y),N=r[2]-r[0],R=r[3]-r[1],E=s.width/N,T=s.height/R,I=getComputedStyle(document.querySelector("html")).getPropertyValue("--secondary");a.fillStyle=I,a.beginPath();const j=F(y);if(Array.isArray(j))for(const g of j[0][0]){const S=(g[0]-r[0])*E,P=s.height-(g[1]-r[1])*T;a.lineTo(S,P)}a.closePath(),a.fill()}}},[y,m]),n.jsxs("div",{className:l.cityItem,children:[n.jsx("div",{className:l.preview,onClick:C,children:n.jsx("canvas",{className:l.geojsonPreview,ref:m})}),n.jsxs("div",{className:l.cityDetails,children:[n.jsx("h2",{className:l.cityName,children:O==="ru"?f:e}),n.jsx("div",{className:l.cityRating,children:n.jsx(M,{rating:t,amount:c})})]})]})};async function Y(){return await k("GET","cities","top",null,!1)()}const Z="_container_c3z8_1",J={container:Z},p=14;function st(){const[c,t]=i.useState([]),e=c.length?c.map(f=>i.createElement(X,{...f,key:f.code})):n.jsx("h3",{children:G.noCities});return i.useEffect(()=>{(async function(){const o=await Y();o.data&&t(o.data)})()},[]),n.jsxs("div",{className:"cities",children:[n.jsx($,{}),n.jsx("div",{className:J.container,children:e})]})}export{st as Cities,p as ZOOM_ON_CITY};
