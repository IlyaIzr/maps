{"version":3,"sources":["requests/config.js","requests/map.js","rest/config.js","rest/colors.js","Map/onLoad.js","store/app.js","Map/filters.js","Map/onClick.js","requests/friends.js","store/user.js","rest/lang.js","rest/helperFuncs.js","Map/addControl.js","Map/onMove.js","Map/Map.jsx","Map/Rater.jsx","Map/Featurer.jsx","Map/formatGeodata.js","Map/Legend.jsx","Map/Reviews.jsx","Map/Main.jsx","requests/auth.js","rest/Responser.jsx","Auth/Login.jsx","requests/users.js","Auth/Register.jsx","Auth/AuthMain.jsx","navigation/left/DefNav.jsx","navigation/left/LangNav.jsx","store/localstorage.js","navigation/left/ThemeNav.jsx","rest/svg/hamburger.svg","navigation/LeftMenu.jsx","rest/svg/world2.svg","navigation/NavMain.jsx","rest/Modal.jsx","Auth/EditProfile.jsx","Auth/GoogleConfirm.jsx","rest/Toast.jsx","Auth/AlphaReg.jsx","Friends/DefaultLayout.jsx","rest/Loading.jsx","Friends/Profile.jsx","Friends/Results.jsx","Friends/SearchBar.jsx","Friends/AddByLink.jsx","Friends/FriendsMain.jsx","navigation/WatchMode.jsx","App.jsx","store/root.js","reportWebVitals.js","rest/beforeApp.js","index.js"],"names":["api","process","requsetMaker","method","meta","path","body","withCreds","query","options","headers","credentials","JSON","stringify","url","a","fetch","response","json","res","getPlaces","minx","maxx","miny","maxy","f","getUserPlaces","id","getReviews","placeId","getPlacesByTiles","data","postInitReview","postNextReview","deleteReview","timestamp","place","getAdress","lat","lng","typesNeeded","Set","Number","window","geocoderRef","geocode","adress","results","i","length","obj","types","formatted_address","split","find","type","has","address_components","long_name","appThemes","googleCreds","login","name","avatar","token","occupiedLogin","appLanguages","ru","en","brightGreenRed","gradients","standart","blueprint","dark","colors","themeColors","primary","secondary","accent","light","counter","setColors","theme","styleRoot","document","querySelector","style","Object","entries","forEach","colName","colValue","setProperty","initializeThemeColors","styleString","mp","color","head","insertAdjacentHTML","mapOnLoad","map","geoJson","on","e","gradient","addSource","firstSymbolId","getStyle","layers","layer","addLayer","paint","LOGINUSER","LOGOUTUSER","EXPAND_COMMENTS","SHRINK_COMMENTS","SHOW_MAIN","HIDE_MAIN","SET_MODAL","CLOSE_MODAL","SWITCH_THEME","SET_TOAST","CLOSE_TOAST","RERENDERMAP","SET_FRIEND_ID","initialState","isLogged","reviewsShown","mapHidden","modal","toast","mapKey","friendModeId","setLoginStatus","d","status","showMain","hideMain","setModal","modalInfo","message","acceptLabel","cancelLabel","acceptAction","cancelAction","children","closeModal","setToast","toastInfo","clickAction","title","geoJsonFromResponse","places","placeData","geometry","properties","rating","amount","source","sourceLayer","coordinates","polygon","polyFigure","x","y","processPlacesResponse","TEXT","setGeoData","tiledata","setTileData","networkError","msg","smg","localTileData","Map","key","get","set","featureList","mapOnClick","setFeature","resetRater","drawObject","lesserGeometry","feature","geo","res2","turf","union","geoFromTurf","someFeatures","querySourceFeatures","filter","splice","findFeatureClones","zoomOnEvent","zoom","lngLat","flyTo","center","features","queryRenderedFeatures","point","featuresNeeded","ratedBefore","console","log","trash","flyToFeature","featureToRate","getZoom","labelTypes","defaultZoom","getFriends","getRequests","searchUsers","input","getProfileDetails","addFriend","removeFriend","acceptRequest","addByLink","WRITECREDENTIALS","CHANGELEVEL","SETFRIENDS","SETREQUESTS","basicState","level","comments","friends","requests","setCredentials","creds","logIntoApp","logOutOfApp","setUserFriends","friendsArr","setUserRequests","requestsArr","homeLinkBtn","authLinkBtn","profile","routes","language","aboutUs","setsLinkBtn","logout","register","yourLogin","userName","yourPword","secretQuestion","secretHint","secterAnswer","secretValidation","secretReplica","secretReplica2","fillRequiredFields","secretExample","submit","confirm","greetings","firstTimeRate","placeRatingPrefix","placeAmountPrefix","placeAmountNumberEnds1","placeAmountEndsMultiple","push","commentPlacehol","bestRating","worstRating","reviews","noComments","searchPHolder","newFeature","newFeaturePHolder","drawPromptHeader","drawPrompt","acceptDefault","cancelDefault","rateZeroModal","toMain","menu","pickTheme","apply","password","field","tooLong","getLocation","loc","localStorage","getItem","parse","getLayoutCoords","Math","floor","pow","tan","PI","cos","getFriendsInfo","dispatch","requestError","reqs","mapAddControl","createBtn","deleteBtn","setDrawPrompt","draw","MapboxDraw","displayControlsDefault","controls","updateArea","display","getAll","created","centroid","_vectorTileFeature","_x","_y","onclick","changeMode","deleteAll","addControl","mapOnMove","setlayoutXY","range","setWeDataNeed","prevXY","getCenter","currentX","currentY","prev","dataWeHave","dataWeNeed","reactiveData","yOffset","xOffset","add","size","Array","from","keys","tileKey","delete","mapboxgl","accessToken","bryansk","mbStyles","MapArea","geoData","featureTrigger","app","useSelector","state","location","useLocation","useDispatch","mapContainer","useRef","useState","initPlacesCall","useEffect","current","container","MapboxGeocoder","placeholder","google","maps","Geocoder","interval","setInterval","setItem","saveLocation","clearInterval","setMapData","pathname","setTimeout","resize","ref","className","src","alt","sourceId","getSource","setData","speed","Rater","onSubmit","s","hover","setHover","setRating","comment","setComment","onClick","submitAction","onMouseEnter","target","onMouseLeave","star","index","cols","rows","value","onInput","send","asAnonius","Featurer","setName","String","endsWith","formatGeodata","multiPoly","north","east","south","west","polyPoints","polyCoords","polyArray","shapeIndex","lon","join","polygonMapper","multiFormatted","Legend","backgroundColor","background","Reviews","updateLayers","userId","user","setReviews","deleteClick","attributes","grade","removeComment","rev","author","toFixed","review","anonimus","to","toUpperCase","Date","toLocaleDateString","Boolean","noreviews","expandComments","Main","setFeatureTrigger","mapTrigger","setMapTrigger","northEastest","southWestest","polyString","tempBox","LngLatBounds","targetId","loginWithCreds","refresh","loginbyGoogle","Responser","setMessage","cn","Login","history","useHistory","setLogin","pword","setPword","setMsg","loading","wrongAuth","errorReg","errCode","farewell","onOAuth","googleUser","getBasicProfile","getName","getImageUrl","gmail","getEmail","getAuthResponse","id_token","getId","onFail","gapi","load","auth2","init","then","auth","signOut","signin2","render","width","height","longtitle","onsuccess","onfailure","htmlFor","autoFocus","data-onsuccess","registerUser","registerGUser","updateUser","updateUserPword","setLanguage","lang","initCreds","question","answer","Register","setCreds","replica","setReplica","focus","toLocaleLowerCase","capitalize","successfullReg","loginOccupied","bannedPwod","required","autoComplete","AuthMain","reg","URLSearchParams","search","isLogging","setIsLogging","DefNav","setNavState","hideSelf","hideMainMenu","navStates","LangNav","setLang","reload","error","documentElement","default","pickLanguage","getPreferences","prefs","projectPrefix","initLocalStorage","setPreference","preference","_g","ThemeNav","indexOf","themeN","setThemeN","themeNumber","LeftMenu","leftMenu","setLeftMenu","navState","_excluded","_extends","assign","arguments","prototype","hasOwnProperty","call","this","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgHamburger","_ref","svgRef","titleId","props","fill","enableBackground","viewBox","xmlSpace","xmlns","xmlnsXlink","ForwardRef","SvgWorld2","NavMain","watchMode","friend","initials","Modal","undefined","EditProfile","secretChallenge","setSecretChallenge","preventDefault","successfulUpdate","c","editProfile","readOnly","GoogleConfirm","oauthTitle","occupied","Toast","visibility","setVisibility","t","onmouseover","clearTimeout","main","info","bg","border","warning","complete","AlphaReg","link","origin","DefaultLayout","userID","friendList","id1","id2","sadlyNoFriends","friendRequests","addMeLink","onFocus","select","Loading","Profile","useParams","curUser","store","setUser","setLoading","friendButton","setFriendButton","friendStatus","inFriendlist","youRequested","confirmRequest","addFriendReq","sent","removeFriendReq","commentsn","noResults","Results","searchResults","SearchBar","setSearchResults","setInput","submitEnter","goBack","onKeyDown","AddByLink","paramId","setId","setLink","setReadOnly","yourFriendsNow","pasteAddLink","val","includes","q","FriendsMain","exact","loginToUseThis","authorization","WatchMode","watchModeSub1","watchModeSub2","addFriends","reset","App","skipLogin","skip","wannaAuthorize","rootReducer","combineReducers","act","newLevel","random","createStore","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","initActions","charAt","slice","preferences","appInitialState","userInitialState","initConnectionErr","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.f9bf37b5.chunk.js","sourcesContent":["if (process.env.NODE_ENV === 'production') {\r\n  var prodAdress = process.env.REACT_APP_PROD\r\n}\r\n\r\nexport const host = prodAdress || process.env.REACT_APP_LOCAL\r\nexport const api = host + 'api/'\r\n\r\n\r\nexport function requsetMaker(method = 'GET', meta = 'auth', path = 'refresh', body = {}, withCreds = true, query = '') {\r\n  const options = {\r\n    method,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n  }\r\n\r\n  if (withCreds) options.credentials = 'include'\r\n  if (body) options.body = JSON.stringify({ ...body })\r\n\r\n  const url = api + meta + '/' + path + (query && '?' + query)\r\n  \r\n  return async function () {\r\n    try {\r\n      const response = await fetch(url, options)\r\n      const res = await response.json()\r\n      return res\r\n    } catch (err) {\r\n      return err\r\n    }\r\n  }\r\n}","import { requsetMaker } from './config'\r\n\r\nexport async function getPlaces(minx = 0, maxx = 99999999, miny = 0, maxy = 99999999) {\r\n  const f = requsetMaker('GET', 'maps', 'places', null, false, `minx=${minx}&miny=${miny}&maxx=${maxx}&maxy=${maxy}`)\r\n  return await f()\r\n}\r\n\r\nexport async function getUserPlaces(id) {\r\n  const f = requsetMaker('GET', 'maps', 'userPlaces', null, false, `id=${id}`)\r\n  return await f()\r\n}\r\n\r\nexport async function getReviews(placeId) {\r\n  const f = requsetMaker('GET', 'maps', 'reviews', null, false, `targetId=${placeId}`)\r\n  return await f()\r\n}\r\n\r\nexport async function getPlacesByTiles(data) {\r\n  const f = requsetMaker('POST', 'maps', 'placesByTiles', { ...data }, false)\r\n  return await f()\r\n}\r\n\r\nexport async function postInitReview(data) {\r\n  const f = requsetMaker('POST', 'maps', 'postInitReview', { ...data }, false)\r\n  return await f()\r\n}\r\n\r\nexport async function postNextReview(data) {\r\n  const f = requsetMaker('POST', 'maps', 'postNextReview', { ...data }, false)\r\n  return await f()\r\n}\r\n\r\nexport async function deleteReview(timestamp, place) {\r\n  const f = requsetMaker('DELETE', 'maps', 'reviews', { timestamp, place }, true)\r\n  return await f()\r\n}\r\n\r\n\r\n\r\nexport async function getAdress(lat, lng) {\r\n  const typesNeeded = new Set(\r\n    ['street_address', 'natural_feature', 'airport', 'park', 'point_of_interest', \"establishment\", \"food\", \"store\"]\r\n  )\r\n  lat = Number(lat)\r\n  lng = Number(lng)\r\n\r\n  // Get decent adress from geocoder\r\n  const res = await window.geocoderRef.geocode({ 'location': { lat, lng } });\r\n\r\n  let adress = \"\"\r\n  if (res.results) {\r\n    for (let i = 0; i < res.results.length; i++) {\r\n      const obj = res.results[i];\r\n      if (obj.types[0] === 'premise') {\r\n        adress = obj.formatted_address.split(', ')[0] + ', ' + obj.formatted_address.split(', ')[1];\r\n        break\r\n      }\r\n      if (obj.types.find(type => typesNeeded.has(type))) {\r\n        adress = obj.address_components[1].long_name + ', ' + obj.address_components[0].long_name\r\n        break\r\n      }\r\n    }\r\n    // TODO error handling\r\n  }\r\n  return adress\r\n}\r\n\r\n// TMP\r\n\r\n// export async function postPlaceName(name, id) {\r\n//   const options = {\r\n//     method: 'POST',\r\n//     headers: {\r\n//       'Content-Type': 'application/json',\r\n//     },\r\n//     body: JSON.stringify({ name, id })\r\n//   }\r\n//   try {\r\n//     const response = await fetch(api + 'maps/postPlaceName', options)\r\n//     const res = await response.json()\r\n//     return res\r\n//   } catch (err) {\r\n//     return err\r\n//   }\r\n// }","export const appThemes = ['standart', 'dark', 'b&w', 'blueprint']\r\n\r\nexport const projectPrefix = 'mp'\r\n\r\nexport let googleCreds = {\r\n  login: null,\r\n  name: null,\r\n  avatar: null,\r\n  token: null,\r\n  occupiedLogin: null,\r\n  id: null\r\n}\r\n\r\nexport const appLanguages = {\r\n  ru: 'ru',\r\n  en: 'en'\r\n}","// Map rating colors\r\n// const draftYellowPurple = ['#e9d5b8', '#e9c5ae', '#dfb7b6', '#d59dbd', '#c379cd', '#f729f6']\r\n// const linearYellowPurpleMeak = ['#e9d1ba', '#edacc6', '#ef8fd1', '#f173db', '#f354e6', '#f729f6']\r\n// const blackToPuplre = ['#170f11', '#2e122e', '#4a1c4a', '#6f2a6f', '#993a99', '#e262c9']\r\n// const redGoldExperiment = ['#5b263c', '#a74b2f',  '#e2734a', '#d5aa83', '#e49b3b', 'gold']\r\n// const linearYellowPurpleBright = ['#eedd71', '#efc682', '#f1a69a', '#f28faa', '#f469c6', '#f729f6']\r\n// const greenRedClassics = ['#712d2d', '#a74b2f', '#e2734a', '#e1b87a', '#8bd38b', '#18a019']\r\n\r\nimport { appThemes } from \"./config\"\r\n\r\n// const lightGreenRed = ['#712d2d', '#a74b2f', '#e2734a', '#e8c337', '#abff38', '#88ff45']\r\nconst brightGreenRed = ['#cd0c0c', '#e14612', '#e1922c', '#e8c337', '#94c52f', '#0aa112']\r\nconst megaBrightGreenRed = [\r\n  '#610505', '#a82d00',\r\n  '#c7c400', '#b3a700',\r\n  '#88c70a', '#00e00b'\r\n]\r\nconst paleGreenRed = [\r\n  '#422424', '#723e36',\r\n  '#866b3c', '#afb766',\r\n  '#96ce7e', '#5fb961'\r\n]\r\nconst dynamicGreenRed = [\r\n  '#422424', '#723e36',\r\n  '#866b3c', '#afb766',\r\n  '#6bc41c', '#149f04'\r\n]\r\n\r\n\r\nexport const gradient = brightGreenRed\r\n\r\nexport const gradients = {\r\n  standart: brightGreenRed,\r\n  blueprint: dynamicGreenRed,\r\n  dark: megaBrightGreenRed,\r\n  'b&w': paleGreenRed\r\n}\r\n\r\n\r\n// const colors = {\r\n//   primary: 'primary',\r\n//   secondary: 'secondary',\r\n//   accent: 'accent',\r\n//   light: 'light',\r\n//   dark: 'dark',\r\n//   counter: 'counter',\r\n// }\r\nconst colors = [\r\n  'primary',\r\n  'secondary',\r\n  'accent',\r\n  'light',\r\n  'dark',\r\n  'counter',\r\n  // 'comply'?\r\n]\r\n\r\nexport const themeColors = {\r\n  standart: {\r\n    primary: \"#05304a\",\r\n    secondary: \"#b6c8d6\",\r\n    accent: \"#1bbc00\",\r\n    light: \"#ffffff\",\r\n    dark: \"#494949\",\r\n    counter: \"#2d8bcf\",\r\n  },\r\n  dark: {\r\n    primary: '#BB86FC',\r\n    secondary: '#a485c8',\r\n    accent: '#03DAC6',\r\n    light: '#383736',\r\n    dark: '#d8d8d8',\r\n    counter: '#e4d737',\r\n    // comply: '#0383da'\r\n  },\r\n  'b&w': {\r\n    primary: '#444444',\r\n    secondary: '#747474',\r\n    accent: '#676767',\r\n    light: '#ffffff',\r\n    dark: '#000000',\r\n    counter: '#616161',\r\n  },\r\n  blueprint: {\r\n    'primary': '#f0a2de',\r\n    'secondary': '#c9abca',\r\n    'accent': '#e9eb7d',\r\n    'light': '#34568b',\r\n    'dark': '#ffffff',\r\n    'counter': '#9affd5',\r\n  }\r\n}\r\n\r\nexport function setColors(theme = appThemes[0]) {\r\n  const styleRoot = document.querySelector(\":root\").style\r\n  Object.entries(themeColors[theme]).forEach(([colName, colValue]) => styleRoot.setProperty('--' + colName, colValue))\r\n}\r\n\r\nexport function initializeThemeColors() {\r\n  let styleString = \"\"\r\n  const mp = '.mp'\r\n\r\n  colors.forEach(color => {\r\n    styleString += `\r\n    ${mp}-${color}{color: var(--${color})}\r\n    ${mp}-${color}-hover:hover{color: var(--${color})}\r\n\r\n    ${mp}-bg-${color}{background-color: var(--${color})}\r\n    ${mp}-bg-${color}-hover:hover{background-color: var(--${color})}\r\n\r\n    ${mp}-border-${color}{border-color: var(--${color})}\r\n    ${mp}-shadow-${color}{ box-shadow: var(--${color}) 2px 2px 4px }\r\n    `\r\n  })\r\n\r\n\r\n  document.head.insertAdjacentHTML(\"beforeend\", `<style>${styleString}</style>`)\r\n}","import { gradients, themeColors } from \"../rest/colors\";\r\n\r\nexport function mapOnLoad(map, geoJson, theme) {\r\n  map.on('load', function (e) {\r\n    const gradient = gradients[theme]\r\n\r\n    // Define a source before using it to create a new layer\r\n    map.addSource('ratedFeaturesSource', {\r\n      type: 'geojson',\r\n      data: {\r\n        \"type\": \"FeatureCollection\",\r\n        \"features\": geoJson\r\n      },\r\n    });\r\n    map.addSource('selectedFeatureSrc', {\r\n      type: 'geojson',\r\n      data: {\r\n        \"type\": \"FeatureCollection\",\r\n        \"features\": []\r\n      },\r\n    });\r\n\r\n\r\n    // Draw data on map\r\n\r\n    // __draw our layer underneath labels\r\n    const layers = map.getStyle().layers;\r\n    const firstSymbolId = layers.find(layer => layer.type === 'symbol').id;\r\n\r\n    map.addLayer({\r\n      'id': 'ratedFeatures',\r\n      'source': 'ratedFeaturesSource',\r\n      // 'source-layer': 'building',\r\n      'minzoom': 11,\r\n      'type': 'fill',\r\n      paint: {\r\n        // TODO opacity formula\r\n        // 'fill-opacity': [\r\n        //   \"interpolate\", [\"linear\"], ['get', 'amount'],\r\n\r\n        //   0, 0,\r\n        //   1, 0.3,\r\n        //   2, 0.4,\r\n        //   3, 0.5,\r\n        //   4, 0.6,\r\n        //   5, 0.7,\r\n        //   10, 0.8,\r\n        //   15, 0.9\r\n        // ],\r\n        'fill-opacity': [\r\n          \"interpolate\", [\"linear\"], ['get', 'amount'],\r\n\r\n          0, 0,\r\n          1, 0.5,\r\n          2, 0.8,\r\n          5, 0.9,\r\n        ],\r\n        // 'fill-opacity': 0.9,\r\n\r\n        'fill-color': [\r\n          \"interpolate\", [\"linear\"], ['get', 'rating'],\r\n\r\n          0, gradient[0],\r\n          1, gradient[1],\r\n          2, gradient[2],\r\n          3, gradient[3],\r\n          4, gradient[4],\r\n          5, gradient[5]\r\n          // 1, '#eee2cc',\r\n          // 5, gradient[5]\r\n        ]\r\n      }\r\n    }, firstSymbolId)\r\n\r\n    map.addLayer({\r\n      'id': 'selectedFeature',\r\n      'source': 'selectedFeatureSrc',\r\n      'minzoom': 13,\r\n      'type': 'fill',\r\n      paint: {\r\n        'fill-opacity': 0.9,\r\n        'fill-color': themeColors[theme].accent,\r\n        'fill-outline-color': themeColors[theme].counter\r\n      }\r\n    }, firstSymbolId)\r\n\r\n  })\r\n}","import { appThemes } from \"../rest/config\"\r\n\r\n/* #region Name consts  */\r\n\r\nconst LOGINUSER = 'app/log_in'\r\nconst LOGOUTUSER = 'app/log_out'\r\nconst EXPAND_COMMENTS = 'app/expand_comms'\r\nconst SHRINK_COMMENTS = 'app/shrink_comms'\r\nconst SHOW_MAIN = 'app/show_main'\r\nconst HIDE_MAIN = 'app/hide_main'\r\nconst SET_MODAL = 'app/set_modal'\r\nconst CLOSE_MODAL = 'app/close_modal'\r\nconst SWITCH_THEME = 'app/switch_theme'\r\nconst SET_TOAST = 'app/set_toast'\r\nconst CLOSE_TOAST = 'app/close_toast'\r\nconst RERENDERMAP = 'app/rerender_map'\r\nconst SET_FRIEND_ID = 'app/friend_id'\r\n\r\n/* #endregion */\r\n\r\n\r\n/* #region  Init State */\r\n\r\nexport const initialState = {\r\n  isLogged: false,\r\n  reviewsShown: true,\r\n  mapHidden: false,\r\n  modal: false,\r\n  // modal: {\r\n  //   message: 'sada',\r\n  //   acceptLabel: 'YES',\r\n  //   cancelLabel: 'NO',\r\n  //   acceptAction: () => { },\r\n  //   cancelAction: () => { }\r\n  // },\r\n  theme: appThemes[0],\r\n  toast: false,\r\n  // toast: {\r\n  //   message: 'some msg',\r\n  //   clickAction: () => { },\r\n  //   status: 'error', // also 'warning', 'info', 'complete',\r\n  //   title: ''\r\n  // }\r\n  mapKey: 1000,\r\n  friendModeId: null\r\n}\r\n\r\n/* #endregion */\r\n\r\n// Reducer\r\n\r\nexport function appReducer(state = initialState, act) {\r\n  switch (act.type) {\r\n    case LOGINUSER: {\r\n      return {\r\n        ...state, isLogged: true\r\n      }\r\n    }\r\n    case LOGOUTUSER: {\r\n      return {\r\n        ...state, isLogged: false\r\n      }\r\n    }\r\n    case SHRINK_COMMENTS: {\r\n      return {\r\n        ...state, reviewsShown: false\r\n      }\r\n    }\r\n    case EXPAND_COMMENTS: {\r\n      return {\r\n        ...state, reviewsShown: true\r\n      }\r\n    }\r\n    case SHOW_MAIN: {\r\n      return {\r\n        ...state, mapHidden: false\r\n      }\r\n    }\r\n    case HIDE_MAIN: {\r\n      return {\r\n        ...state, mapHidden: true\r\n      }\r\n    }\r\n    case SET_MODAL: {\r\n      return {\r\n        ...state, modal: act.modalInfo\r\n      }\r\n    }\r\n    case CLOSE_MODAL: {\r\n      return {\r\n        ...state, modal: false\r\n      }\r\n    }\r\n    case SWITCH_THEME: {\r\n      return {\r\n        ...state, theme: act.theme\r\n      }\r\n    }\r\n    case SET_TOAST: {\r\n      const key = Math.random()\r\n      return {\r\n        ...state, toast: { ...act.toastInfo, key }\r\n      }\r\n    }\r\n    case CLOSE_TOAST: {\r\n      return {\r\n        ...state, toast: false\r\n      }\r\n    }\r\n    case RERENDERMAP: {\r\n      return {\r\n        ...state, mapKey: Number(state.mapKey) + 1\r\n      }\r\n    }\r\n    case SET_FRIEND_ID: {\r\n      return {\r\n        ...state, friendModeId: act.id\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\n/* #region  Actions */\r\n\r\nexport const setLoginStatus = (d, status = false) => {\r\n  if (status) d({ type: LOGINUSER })\r\n  else d({ type: LOGOUTUSER })\r\n}\r\n\r\nexport const expandComments = (d) => {\r\n  d({ type: EXPAND_COMMENTS })\r\n}\r\n\r\nexport const shrinkComments = (d) => {\r\n  d({ type: SHRINK_COMMENTS })\r\n}\r\n\r\nexport const showMain = (d) => {\r\n  d({ type: SHOW_MAIN })\r\n}\r\n\r\nexport const hideMain = (d) => {\r\n  d({ type: HIDE_MAIN })\r\n}\r\n\r\nexport const setModal = (d, modalInfo = {\r\n  message: '',\r\n  acceptLabel: '',\r\n  cancelLabel: '',\r\n  acceptAction() { },\r\n  cancelAction() { },\r\n  children: <></>\r\n}) => {\r\n  d({ type: SET_MODAL, modalInfo })\r\n}\r\n\r\nexport const closeModal = (d) => {\r\n  d({ type: CLOSE_MODAL })\r\n}\r\n\r\nexport const switchTheme = (d, theme) => {\r\n  if (appThemes.indexOf(theme) < 0) theme = appThemes[0]\r\n  d({ type: SWITCH_THEME, theme })\r\n  console.log('%c⧭', 'color: #7f7700', 'theme switched');\r\n}\r\n\r\nexport const setToast = (d, toastInfo = {\r\n  message: '',\r\n  clickAction() { },\r\n  status: 'error', // also 'warning', 'info', 'complete',\r\n  title: ''\r\n}) => {\r\n  d({ type: SET_TOAST, toastInfo })\r\n}\r\n\r\nexport const closeToast = (d) => {\r\n  d({ type: CLOSE_TOAST })\r\n}\r\n\r\nexport const rerenderMap = (d) => {\r\n  d({ type: RERENDERMAP })\r\n}\r\n\r\nexport const friendModeId = (d, id) => {\r\n  d({ type: SET_FRIEND_ID, id })\r\n}\r\n\r\n/* #endregion */\r\n","import { setToast } from \"../store/app\"\r\n\r\nexport function geoJsonFromResponse(places) {\r\n  if (!places?.length) return []\r\n\r\n  const geoJson = places.map(placeData => {\r\n    const res = {\r\n      type: 'Feature',\r\n      geometry: {\r\n        type: \"MultiPolygon\",\r\n      },\r\n      id: placeData.id,\r\n      properties: {\r\n        rating: Number(placeData.rating),\r\n        amount: placeData.amount,\r\n        name: placeData.name,\r\n        lng: placeData.lng,\r\n        lat: placeData.lat,\r\n        // x: placeData.x,\r\n        // y: placeData.y\r\n      },\r\n      source: \"composite\",\r\n      sourceLayer: \"building\",\r\n    }\r\n    // if (placeData?.polygon?.length > 1) res.geometry.type = \"MultiPolygon\"\r\n\r\n    // Case multypolygon\r\n    res.geometry.coordinates = placeData?.polygon?.map(polygon => polygon.map(polyFigure => {\r\n      return polyFigure.map(polygon => [polygon.x, polygon.y])\r\n    }))\r\n    return res\r\n    // some async problem, althought setstate has no promise so ;)\r\n    // setTileData(prevState => {\r\n    //   console.log('%c⧭', 'color: #00e600', prevState);\r\n    //   if (prevState.has(key)) prevState.get(key).push(res)\r\n    //   else prevState.set(key, [res])\r\n    //   console.log('%c⧭', 'color: #0c550c', prevState);\r\n    // })\r\n  })\r\n  return geoJson\r\n}\r\n\r\n\r\nexport function processPlacesResponse(res, d, TEXT, setGeoData, tiledata, setTileData) {\r\n  if (res.status !== 'OK') return setToast(d, { title: TEXT.networkError, message: typeof res.msg === 'object' ? JSON.stringify(res.msg) : res.msg || JSON.stringify(res.smg) })\r\n  // Pass array of places upwards, to mapbox\r\n  const geoJson = geoJsonFromResponse(res.data)\r\n  setGeoData(geoJson)\r\n  // Update current tile data\r\n\r\n  const localTileData = new Map([...tiledata])\r\n\r\n  res.data.forEach(placeData => {\r\n    const res = {\r\n      type: 'Feature',\r\n      geometry: {\r\n        type: \"MultiPolygon\",\r\n      },\r\n      id: placeData.id,\r\n      properties: {\r\n        rating: Number(placeData.rating),\r\n        amount: placeData.amount,\r\n        name: placeData.name,\r\n        lng: placeData.lng,\r\n        lat: placeData.lat,\r\n        // x: placeData.x,\r\n        // y: placeData.y\r\n      },\r\n      source: \"composite\",\r\n      sourceLayer: \"building\",\r\n    }\r\n\r\n    const key = 'x' + placeData.x + 'y' + placeData.y\r\n    if (localTileData.has(key)) localTileData.get(key).set(placeData.id, res)\r\n    else {\r\n      const featureList = new Map()\r\n      featureList.set(placeData.id, res)\r\n      localTileData.set(key, featureList)\r\n    }\r\n  })\r\n\r\n  setTileData(localTileData)\r\n\r\n  return geoJson\r\n}","import { getAdress } from \"../requests/map\"\r\nimport { flyToFeature } from \"./Map\"\r\n\r\nexport function mapOnClick(map, setFeature, resetRater, drawObject) {\r\n  function geoFromTurf(geo) {\r\n    if (!geo[1]) return geo[0]\r\n    let res2 = window.turf.union(geo[0], geo[1])\r\n    if (geo[2]) for (let i = 2; i < geo.length; i++) {\r\n      res2 = window.turf.union(res2, geo[i])\r\n    }\r\n\r\n    return res2.geometry\r\n  }\r\n  function findFeatureClones(feature) {\r\n    const someFeatures = map.querySourceFeatures(\"composite\",\r\n      {\r\n        filter: [\"any\", [\"==\", [\"id\"], feature.id]],\r\n        sourceLayer: feature.sourceLayer\r\n      }\r\n    )\r\n    someFeatures.splice(someFeatures.length / 2)\r\n    return someFeatures.map(f => f.geometry)\r\n  }\r\n  function lesserGeometry(feature) {\r\n    const features = findFeatureClones(feature) || []\r\n    return geoFromTurf(features)\r\n  }\r\n\r\n  map.on('click', async function (e) {\r\n    function zoomOnEvent(zoom) {\r\n      const { lng, lat } = e.lngLat\r\n      map.flyTo({ center: [lng, lat], zoom: zoom });\r\n    }\r\n    // if (map.getZoom() < 16) zoomOnEvent(16)\r\n\r\n    const features = map.queryRenderedFeatures(e.point);\r\n    const featuresNeeded = new Set(['building', 'landuse'])\r\n\r\n    // Case next timer\r\n    const ratedBefore = features.find(feature => feature.source === 'ratedFeaturesSource')\r\n    if (ratedBefore) {\r\n      console.log('found rated feature', ratedBefore);\r\n      drawObject.trash()\r\n\r\n\r\n      flyToFeature(map, ratedBefore)\r\n      setFeature(ratedBefore)\r\n      return;\r\n    }\r\n\r\n    // Case first timer\r\n    const featureToRate = features.find(feature => featuresNeeded.has(feature.sourceLayer))\r\n    if (featureToRate?.id) {\r\n      console.log('found feature', featureToRate);\r\n      drawObject.trash()\r\n\r\n\r\n      const zoom = map.getZoom()\r\n      const [lng, lat] = flyToFeature(map, featureToRate, zoom < 16 ? 16 : zoom) //TODO make some sort of buffer \r\n      const geometry = lesserGeometry(featureToRate)\r\n\r\n      featureToRate.properties.name = await getAdress(lat, lng)\r\n\r\n      setFeature({ ...featureToRate, geometry })\r\n      return;\r\n\r\n    } else if (featureToRate) {\r\n      console.log('interesting, but no id', featureToRate);\r\n      drawObject.trash()\r\n\r\n      zoomOnEvent(map.getZoom() + 1)\r\n      setFeature(null)\r\n      return;\r\n    }\r\n    else {\r\n      if (features?.[0]?.source === 'mapbox-gl-draw-hot') return;\r\n      console.log('no interesting features', features);\r\n\r\n\r\n      const labelTypes = new Set(['natural_label', 'place_label', 'poi_label', 'housenum_label', 'airport_label'])\r\n      const labelFeature = features.find(feature => labelTypes.has(feature.sourceLayer))\r\n      if (labelFeature) {\r\n        const defaultZoom = map.getZoom() + 1\r\n        defaultZoom < 16 && zoomOnEvent(defaultZoom)\r\n      }\r\n      resetRater()\r\n      return;\r\n    }\r\n  });\r\n}","import { requsetMaker } from \"./config\"\r\n\r\nexport async function getFriends() {\r\n  const f = requsetMaker('GET', 'friends', 'all', null, true)\r\n  return await f()\r\n}\r\n\r\nexport async function getRequests() {\r\n  const f = requsetMaker('GET', 'friends', 'requests', null, true)\r\n  return await f()\r\n}\r\n\r\nexport async function searchUsers(input) {\r\n  const f = requsetMaker('GET', 'friends', 'search', null, true, 'input=' + input)\r\n  return await f()\r\n}\r\n\r\nexport async function getProfileDetails(id) {\r\n  const f = requsetMaker('GET', 'friends', 'details', null, true, 'id=' + id)\r\n  return await f()\r\n}\r\n\r\n// Make friend request\r\nexport async function addFriend(id) {\r\n  const f = requsetMaker('GET', 'friends', 'add', null, true, 'id=' + id)\r\n  return await f()\r\n}\r\n\r\nexport async function removeFriend(id) {\r\n  const f = requsetMaker('GET', 'friends', 'remove', null, true, 'id=' + id)\r\n  return await f()\r\n}\r\n\r\nexport async function acceptRequest(id) {\r\n  const f = requsetMaker('GET', 'friends', 'accept', null, true, 'id=' + id)\r\n  return await f()\r\n}\r\n\r\nexport async function addByLink(id) {\r\n  const f = requsetMaker('GET', 'friends', 'addByLink', null, true, 'id=' + id)\r\n  return await f()  \r\n}\r\n","import { setLoginStatus } from './app'\r\n// Name consts\r\nconst WRITECREDENTIALS = 'user/set_credentials'\r\nconst CHANGELEVEL = 'user/set_level'\r\nconst SETFRIENDS = 'user/set_friends'\r\nconst SETREQUESTS = 'user/set_requests'\r\n\r\n// Reducer\r\nconst basicState = {\r\n  name: 'anonimus',\r\n  login: '',\r\n  level: 0,\r\n  id: 'anonimus',\r\n  comments: 0,\r\n  avatar: null,\r\n  friends: [],\r\n  requests: []\r\n}\r\nexport let initialState = { ...basicState }\r\n\r\nexport function userReducer(state = initialState, act) {\r\n  switch (act.type) {\r\n    case WRITECREDENTIALS: {\r\n      return {\r\n        ...state, ...act.credentials\r\n      }\r\n    }\r\n    case CHANGELEVEL: {\r\n      return {\r\n        ...state, level: act.newLevel\r\n      }\r\n    }\r\n    case SETFRIENDS: {\r\n      return {\r\n        ...state, friends: [...act.friendsArr]\r\n      }\r\n    }\r\n    case SETREQUESTS: {\r\n      return {\r\n        ...state, requests: [...act.requestsArr]\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\n// Actions\r\nexport const setCredentials = (d, creds) => {\r\n  d({ type: WRITECREDENTIALS, credentials: { ...creds } })\r\n}\r\nexport const logIntoApp = (d, creds) => {\r\n  setCredentials(d, creds)\r\n  setLoginStatus(d, true)\r\n}\r\nexport const logOutOfApp = (d) => {\r\n  setCredentials(d, basicState)\r\n  setLoginStatus(d, false)\r\n}\r\n\r\nexport const setUserLevel = (d, level) => {\r\n  d({ type: WRITECREDENTIALS, newLevel: Number(level) })\r\n}\r\n\r\nexport const setUserFriends = (d, friends = []) => {\r\n  d({ type: SETFRIENDS, friendsArr: friends })\r\n}\r\nexport const setUserRequests = (d, requests = []) => {\r\n  d({ type: SETREQUESTS, requestsArr: requests })\r\n}","\r\n// const basicLanguage = {\r\n//   homeLinkBtn: \"Home\",\r\n//   authLinkBtn: \"Authorize\",\r\n//   setsLinkBtn: \"Settings\",\r\n//   login: \"Login\",\r\n//   register: 'Register',\r\n//   yourName: 'Your name',\r\n//   submit: 'Submit',\r\n//   confirm: 'Confirm',\r\n//   greetings: 'Hello there',\r\n//   firstTimeRate: 'You have an honor to be first to rate this place!',\r\n//   placeRatingPrefix: 'This place has rating of',\r\n//   placeAmountPrefix: 'Rated',\r\n//   placeAmountNumberEnds1: 'time',\r\n//   placeAmountNPostfix: 's',\r\n//   push: 'Push',\r\n//   commentPlacehol: 'any comments?'\r\n// }\r\n\r\nimport { appThemes } from \"./config\"\r\n\r\n\r\nconst ru = {\r\n  ru: 'русский',\r\n  en: 'английский',\r\n  homeLinkBtn: \"Главная\",\r\n  authLinkBtn: \"Логин\",\r\n  profile: \"Профиль\",\r\n  theme: \"Тема\",\r\n  friends: \"Друзья\",\r\n  routes: \"Маршруты\",\r\n  language: \"Язык\",\r\n  aboutUs: \"О нас\",\r\n  setsLinkBtn: \"Настройки\",\r\n  login: \"Логин\",\r\n  logout: 'Выйти',\r\n  register: 'Регистрация',\r\n  yourLogin: 'Ваш логин',\r\n  userName: 'Имя пользователя',\r\n  yourPword: 'Ваш пароль',\r\n  secretQuestion: 'Секретный вопрос',\r\n  secretHint: 'Для восстановления пароля',\r\n  secterAnswer: 'Ответ на секрет',\r\n  secretValidation: 'Вы указали вопрос, укажите и ответ',\r\n  secretReplica: 'Но это не я написал вопрос!',\r\n  secretReplica2: 'А ответ нам всё равно нужен',\r\n  fillRequiredFields: 'Заполните необходимые поля',\r\n  secretExample: 'Имя, которое вы тайно ненавидите',\r\n  submit: 'Отправить',\r\n  confirm: 'Подтвердить',\r\n  greetings: 'Привет',\r\n  firstTimeRate: 'Вам выпала честь первым оценить это место!',\r\n  placeRatingPrefix: 'Общий рейтинг',\r\n  placeAmountPrefix: 'Это место оценили',\r\n  placeAmountNumberEnds1: 'раз',\r\n  placeAmountEndsMultiple: 'раза',\r\n  push: 'Нажать',\r\n  commentPlacehol: 'есть комментарии?',\r\n  rating: 'Ваша оценка',\r\n  bestRating: 'Замечательно',\r\n  worstRating: 'Ужасно',\r\n  reviews: 'Отзывы',\r\n  noComments: 'Без комментариев',\r\n  searchPHolder: 'Найти',\r\n  newFeature: 'Новый объект на карте',\r\n  newFeaturePHolder: 'Адрес или название места',\r\n  drawPromptHeader: 'Режим рисования',\r\n  drawPrompt: 'Завершите создание, дважды нажав на последнюю точку полигона',\r\n  level: 'уровень',\r\n  acceptDefault: 'принять',\r\n  cancelDefault: 'отклонить',\r\n  rateZeroModal: 'Действительно поставить оценку 0?',\r\n  toMain: 'На главную',\r\n  menu: 'Меню',\r\n  pickTheme: 'Выберете тему',\r\n  apply: 'Применить',\r\n  password: 'Пароль',\r\n  field: 'поле',\r\n  tooLong: 'слишком длинное',\r\n  [appThemes[0]]: 'Стандартная',\r\n  [appThemes[1]]: 'Тёмная',\r\n  [appThemes[2]]: 'Black&White',\r\n  [appThemes[3]]: 'Чертёжная',\r\n  successfullReg: 'Успешная регистрация!', \r\n  errorReg: 'Возникла ошибка при регистрации', \r\n  errCode: 'код ошибки',\r\n  loginOccupied: 'Логин уже занят',\r\n  wrongAuth: 'Неверные данные для входа',\r\n  editProfile: 'Редактирование профиля',\r\n  successfulUpdate: 'Успешное обновление',\r\n  secretChallenge: 'Вам нужно ответить на секретный вопрос, чтобы изменить пароль',\r\n  loading: 'Загрузка',\r\n  oauthTitle: 'Регистрация через google аккаунт',\r\n  occupied: 'Занят',\r\n  bannedPwod: 'этот пароль недоступен', \r\n  error: 'ошибка',\r\n  warning: 'внимание',\r\n  complete: 'выполнено',\r\n  initConnectionErr: 'Ошибка при подкючении к серверу, авторизация не удалась. Пожалуйста, сообщите об ошибке',\r\n  networkError: 'ошибка подключения к сети',\r\n  wannaAuthorize: 'Хотите авторизоваться?',\r\n  skip: 'пропустить',\r\n  farewell: 'До встречи',\r\n  pickLanguage: 'Выберете язык',\r\n  requestError: 'ошибка при запросе, возможны проблемы с интернетом', \r\n  anonimus: 'Анон',\r\n  removeComment: 'Удалить комментарий',\r\n  friendList: 'Список друзей',\r\n  sadlyNoFriends: 'Печально, друзей у вас нет',\r\n  addFriends: 'добавить друзей',\r\n  noResults: 'Нет результатов',\r\n  // TODO\r\n  loginToUseThis: 'Авторизуйтесь чтобы увидеть своих друзей, их оценки (и в будущем - маршруты), и добавлять новых друзей',\r\n  authorization: 'авторизация',\r\n  avatar: 'аватар',\r\n  commentsn: 'Количество комментариев',\r\n  addFriend: 'Добавить в друзья',\r\n  removeFriend: 'Убрать из друзей',\r\n  inFriendlist: 'В списке друзей',\r\n  sent: 'Отправлено',\r\n  youRequested: 'Вы оставили запрос',\r\n  confirmRequest: 'Принять запрос',\r\n  addMeLink: 'Ссылка для добавления вас в друзья',\r\n  addByLink: 'Добавить по ссылке',\r\n  pasteAddLink: 'Вставьте ссылку для добавления',\r\n  yourFriendsNow: 'Теперь вы друзья',\r\n  goBack: 'Назад',\r\n  friendRequests: 'Предложения дружбы',\r\n  watchMode: 'Режим просмотра',\r\n  watchModeSub1: 'Посмотрите на карте оценки отдельного друга',\r\n  watchModeSub2: 'Добавьте друзей, чтобы увидеть их оценки отдельно',\r\n  default: 'обычный',\r\n  reset: 'сбросить',\r\n  asAnonius: 'как аноним',\r\n  send: 'Отправить',\r\n  signWithGoogle: 'Войти через Google'\r\n}\r\n\r\n// export const TEXT = window.APPTEXT || ru\r\nexport const TEXT =  ru","import { getFriends, getRequests } from \"../requests/friends\"\r\nimport { setToast } from \"../store/app\"\r\nimport { setUserFriends, setUserRequests } from \"../store/user\"\r\nimport { TEXT } from \"./lang\"\r\n\r\nexport function saveLocation({ lng, lat }) {\r\n  window.localStorage.setItem('lastLocation', JSON.stringify({ lng, lat }))\r\n}\r\n\r\nexport function getLocation() {\r\n  let loc = window.localStorage.getItem('lastLocation')\r\n  if (!loc) return {}\r\n  loc = JSON.parse(loc)\r\n  const { lng, lat } = loc\r\n  return { lng, lat }\r\n}\r\n\r\nexport function getLayoutCoords(lng, lat, zoom) {\r\n  const x = Math.floor((lng + 180) / 360 * Math.pow(2, zoom))\r\n  const y = Math.floor((1 - Math.log(Math.tan(lat * Math.PI / 180) + 1 / Math.cos(lat * Math.PI / 180)) / Math.PI) / 2 * Math.pow(2, zoom))\r\n  return { x, y }\r\n}\r\n\r\nexport async function getFriendsInfo(dispatch) {\r\n  const res = await getFriends()\r\n  if (res.status !== 'OK' && res.status !== 'REAUTH') return setToast(dispatch, { message: TEXT.requestError });\r\n  setUserFriends(dispatch, res.data)\r\n\r\n  const reqs = await getRequests()\r\n  if (res.status !== 'OK' && res.status !== 'REAUTH') return setToast(dispatch, { message: TEXT.requestError });\r\n  setUserRequests(dispatch, reqs.data)\r\n}","import { getAdress } from \"../requests/map\";\r\n// eslint-disable-line no-unused-vars\r\n\r\nexport function mapAddControl(map, setFeature, createBtn, deleteBtn, setDrawPrompt, resetRater) {\r\n\r\n  const draw = new window.MapboxDraw({\r\n    displayControlsDefault: false,\r\n    controls: {\r\n      // polygon: true,\r\n      // trash: true\r\n    },\r\n    // defaultMode: 'draw_polygon'\r\n  });\r\n  \r\n  // Create custom controls\r\n  createBtn.onclick = function () {\r\n    draw.changeMode('draw_polygon')\r\n    deleteBtn.style.display = 'block'\r\n    setDrawPrompt(true)\r\n  }\r\n  deleteBtn.onclick = function () {\r\n    draw.deleteAll()\r\n    resetRater()\r\n    setDrawPrompt(false)\r\n    createBtn.style.display = 'block'\r\n    deleteBtn.style.display = 'none'\r\n  }\r\n\r\n  map.addControl(draw);\r\n  createBtn.style.display = 'block'\r\n  deleteBtn.style.display = 'none'\r\n\r\n\r\n  map.on('draw.create', updateArea);\r\n  map.on('draw.update', updateArea);\r\n  // map.on('draw.delete', afterDelete);\r\n  // map.on('draw.selectionchange', afterUnfocus);\r\n  // function afterDelete() {\r\n  // }\r\n  // function afterUnfocus() {\r\n  //   console.log('%c⧭', 'color: #cc7033', 'afterUnfocus');\r\n  // }\r\n\r\n  async function updateArea(e) {    \r\n    setDrawPrompt(false)\r\n    createBtn.style.display = 'none'\r\n\r\n    // console.log('%c⧭', 'color: #8c0038', 'update area func');\r\n\r\n    const data = draw.getAll();\r\n\r\n    if (data.features.length > 0) {\r\n      // TODO if area > 30_000 show error notification, also check for too little area. Also chek if nothing inside\r\n      // const area = window.turf.area(data);\r\n      // restrict to area to 2 decimal points\r\n      // const rounded_area = Math.round(area * 100) / 100;\r\n      // console.log('%c⧭', 'color: #99adcc', rounded_area);\r\n      const feature = { ...data.features[0] }\r\n      feature.properties.amount = 0\r\n      feature.properties.created = true\r\n      feature.source = 'createdPoly'\r\n      const [lng, lat] = window.turf.centroid(feature.geometry).geometry.coordinates\r\n      const zoom = map.getZoom()\r\n      // Vector tile feature calculations\r\n      feature._vectorTileFeature = {\r\n        _x: Math.floor((lng + 180) / 360 * Math.pow(2, zoom)),\r\n        _y: Math.floor((1 - Math.log(Math.tan(lat * Math.PI / 180) + 1 / Math.cos(lat * Math.PI / 180)) / Math.PI) / 2 * Math.pow(2, zoom))\r\n      }\r\n\r\n      feature.properties.name = await getAdress(lat, lng)\r\n      setFeature(feature)\r\n    }\r\n    // if (e.type !== 'draw.delete')\r\n  }\r\n\r\n  return draw\r\n}","import { getLayoutCoords } from \"../rest/helperFuncs\";\r\n\r\nexport function mapOnMove(map, setlayoutXY, range, setWeDataNeed, setTileData) {\r\n  map.on('moveend', function (e) {\r\n    const { lng, lat } = map.getCenter()\r\n    // const zoom = map.getZoom()\r\n    const { x: currentX, y: currentY } = getLayoutCoords(lng, lat, 16)\r\n    let prevXY\r\n    setlayoutXY(prev => {\r\n      prevXY = prev\r\n      return { x: currentX, y: currentY }\r\n    })\r\n\r\n    // Check changes\r\n    if (!prevXY || (prevXY.x === currentX && prevXY.y === currentY)) return;\r\n    // console.log('%c⧭ prevx:', 'color: #00bf00', prevXY);\r\n    // console.log('%c⧭ newx', 'color: #0088cc', currentX);\r\n    // console.log('%c⧭ newy', 'color: #0088cc', currentY);\r\n\r\n    // Case something changed\r\n\r\n    // local variables\r\n    const dataWeNeed = new Set([])\r\n    let dataWeHave\r\n\r\n    setTileData(reactiveData => {\r\n      dataWeHave = reactiveData\r\n\r\n      // Go from top row to bottom\r\n      for (let yOffset = range; yOffset > -range - 1; yOffset--) {\r\n        // From left to right (although in Mapbox y starts from top - North)\r\n        for (let xOffset = -range; xOffset < range + 1; xOffset++) {\r\n          const key = 'x' + (currentX + xOffset) + 'y' + (currentY + yOffset)\r\n          if (dataWeHave.has(key)) continue\r\n          // Add data\r\n          dataWeNeed.add(key)\r\n        }\r\n      }\r\n\r\n      // clean if needed\r\n      if (dataWeNeed.size > 10)\r\n\r\n        Array.from(dataWeHave.keys()).forEach(tileKey => {\r\n          // console.log('%c⧭ tileKey is', 'color: #9c66cc', tileKey);\r\n          // console.log('%c⧭ DWN is', 'color: #00a3cc', dataWeNeed);\r\n          // console.log('%c⧭ DWN has', 'color: #00e600', dataWeNeed.has(tileKey));\r\n          if (dataWeNeed.has(tileKey)) {\r\n            return console.log('%c⧭ it had tilekey', 'color: #e50000', tileKey);\r\n          }\r\n          dataWeHave.delete(tileKey)\r\n        })\r\n\r\n      return reactiveData\r\n    })\r\n\r\n    setWeDataNeed(dataWeNeed)\r\n  })\r\n}","import { useEffect, useRef, useState } from 'react'\r\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\r\nimport { getPlaces, getPlacesByTiles, getUserPlaces } from '../requests/map';\r\nimport { mapOnLoad } from './onLoad';\r\nimport { geoJsonFromResponse, processPlacesResponse } from './filters';\r\nimport { mapOnClick } from './onClick';\r\nimport { getLayoutCoords, getLocation, saveLocation } from '../rest/helperFuncs';\r\nimport { TEXT } from '../rest/lang';\r\nimport { mapAddControl } from './addControl';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { hideMain, setToast, showMain } from '../store/app';\r\nimport { mapOnMove } from './onMove';\r\n\r\n// Settings\r\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_T;\r\nconst range = 3\r\nconst zoom = 16\r\nconst bryansk = {\r\n  lng: 34.354, lat: 53.235\r\n}\r\nconst mbStyles = {\r\n  standart: 'mapbox://styles/ilyaizr/ckq2l808k0ifn17o0x0yl9qi4',\r\n  dark: 'mapbox://styles/ilyaizr/cks1rsp1d3jxs17qo1m3gwxf0',  //from blueprint but with more vary colors\r\n  'b&w': 'mapbox://styles/ilyaizr/ckpk88ybo17tn17mzmd5etst8', //todo, basic map\r\n  blueprint: 'mapbox://styles/ilyaizr/cksp4jldx0b1z17mog8wzg0jm'  //blueprint with less colors\r\n}\r\n\r\nexport const MapArea = ({ feature, setFeature, resetRater, geoData, setGeoData, featureTrigger }) => {\r\n  const app = useSelector(state => state.app)\r\n  const location = useLocation()\r\n  const d = useDispatch()\r\n  const mapContainer = useRef(null);\r\n\r\n  const map = useRef(null);\r\n  const createBtn = useRef(null);\r\n  const deleteBtn = useRef(null);\r\n  const [drawPrompt, setDrawPrompt] = useState(false);\r\n  // Map places data\r\n  const [, setlayoutXY] = useState({ x: null, y: null });\r\n  const [tiledata, setTileData] = useState(new Map())\r\n  const [dataWeNeed, setWeDataNeed] = useState(new Set());\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      if (app.friendModeId) return;\r\n      if (dataWeNeed.size) {\r\n        const res = await getPlacesByTiles([...dataWeNeed])\r\n        processPlacesResponse(res, d, TEXT, setGeoData, tiledata, setTileData)\r\n      }\r\n    })()\r\n    // eslint-disable-next-line \r\n  }, [dataWeNeed]);\r\n\r\n  // const [zoom, setZoom] = useState(16);\r\n\r\n\r\n  // Init map\r\n  useEffect(() => {\r\n    if (map.current && process.env.NODE_ENV === 'development') return;  // initialize map only once, dev environment optimization\r\n\r\n    (async function () {\r\n      const geoJson = await initPlacesCall()\r\n      const { lng, lat } = getLocation()\r\n\r\n      map.current = new mapboxgl.Map({\r\n        container: mapContainer.current,\r\n        style: mbStyles[app.theme],   //  blueprint\r\n        // center: [-122.447303, 37.753574],  // palo alto\r\n        center: [lng || 34.354, lat || 53.235], // bryansk\r\n        zoom\r\n      });\r\n\r\n      // Add search\r\n      map.current.addControl(\r\n        new window.MapboxGeocoder({\r\n          accessToken: process.env.REACT_APP_MAPBOX_T,\r\n          mapboxgl: mapboxgl,\r\n          placeholder: TEXT.searchPHolder\r\n        })\r\n      );\r\n\r\n      const drawObject = mapAddControl(map.current, setFeature, createBtn.current, deleteBtn.current, setDrawPrompt, resetRater)\r\n      // console.log('%c⧭', 'color: #5200cc', p.sty);\r\n      mapOnLoad(map.current, geoJson, app.theme)\r\n      mapOnClick(map.current, setFeature, resetRater, drawObject)\r\n      mapOnMove(map.current, setlayoutXY, range, setWeDataNeed, setTileData)\r\n      window.geocoderRef = new window.google.maps.Geocoder()\r\n    })();\r\n\r\n\r\n    const interval = setInterval(() => {\r\n      const loc = map.current?.getCenter?.()\r\n      if (loc) saveLocation(loc)\r\n    }, 10000);\r\n    // canvas.style.width = '100%'\r\n    // canvas.style.height = '100%'\r\n\r\n    return () => clearInterval(interval)\r\n    // eslint-disable-next-line\r\n  }, [app.theme]);\r\n\r\n\r\n  // Dynamic geodata\r\n  useEffect(() => {\r\n    if (!map.current) return; // wait for map to initialize\r\n    setMapData(map.current, geoData, 'ratedFeaturesSource')\r\n    // eslint-disable-next-line\r\n  }, [featureTrigger, geoData]);\r\n\r\n\r\n  // Mark selected feature\r\n  useEffect(() => {\r\n    if (!map.current) return; // wait for map to initialize\r\n\r\n    setMapData(map.current, [feature || {}], 'selectedFeatureSrc')\r\n    // eslint-disable-next-line\r\n  }, [feature]);\r\n\r\n\r\n  // map hider, helps to awoid extra call to Mapbox\r\n  useEffect(() => {\r\n    if (location.pathname !== '/') hideMain(d)\r\n    else {\r\n      showMain(d)\r\n      // Fix map shrinking. I'm sorry, it only works this wayzz\r\n      setTimeout(() => {\r\n        map.current?.resize()\r\n      }, 0);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [location.pathname]);\r\n\r\n\r\n  // user watchMode\r\n  useEffect(() => {\r\n    if (!map.current) return; // wait for map to initialize\r\n\r\n    (async function () {\r\n      let geoJson\r\n      if (!app.friendModeId) {\r\n        geoJson = await initPlacesCall()\r\n      } else {\r\n        const res = await getUserPlaces(app.friendModeId)\r\n        if (res.status !== 'OK') return setToast(d, { title: TEXT.networkError, message: res.msg || JSON.stringify(res) })\r\n        geoJson = geoJsonFromResponse(res.data)\r\n      }\r\n\r\n      setGeoData(geoJson)\r\n    })()\r\n    // eslint-disable-next-line\r\n  }, [app.friendModeId, app.mapKey]);\r\n\r\n\r\n  async function initPlacesCall() {\r\n    const { lng, lat } = getLocation()\r\n    // const zoom = map.getZoom()\r\n    const { x, y } = getLayoutCoords(lng || bryansk.lng, lat || bryansk.lat, zoom)\r\n    setlayoutXY({ x, y })\r\n    \r\n\r\n    const res = app.friendModeId ?\r\n      await getUserPlaces(app.friendModeId) :\r\n      await getPlaces(x - range, x + range, y - range, y + range)\r\n    const geoJson = processPlacesResponse(res, d, TEXT, setGeoData, tiledata, setTileData)\r\n    return geoJson\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div ref={mapContainer} className={app.mapHidden ? \"map-container hidden\" : \"map-container\"} />\r\n      {/* Add button */}\r\n      <button id=\"createBtn\" ref={createBtn} className=\"mp-bg-light mp-border-primary controlButton\">\r\n        <img src=\"/icons/edit-pen.svg\" alt=\"draw area\" />\r\n      </button>\r\n      {/* Delete button */}\r\n      <button id=\"deleteBtn\" ref={deleteBtn} className=\"mp-bg-light mp-border-primary controlButton\">\r\n        <img src=\"/icons/trash.svg\" alt=\"cancel drawing\" />\r\n      </button>\r\n      {/* Helper prompt */}\r\n      {drawPrompt && <div className=\"controlPrompt mp-border-counter mp-bg-light\">\r\n        <h6>{TEXT.drawPromptHeader}</h6>\r\n        <p>{TEXT.drawPrompt}</p>\r\n      </div>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function setMapData(map, geoData, sourceId) {\r\n  map.getSource(sourceId)?.setData({\r\n    \"type\": \"FeatureCollection\",\r\n    \"features\": geoData\r\n  })\r\n}\r\n\r\nexport function flyToFeature(map, feature, zoom = 16, speed = 0.5) {\r\n  const [lng, lat] = window.turf.centroid(feature.geometry).geometry.coordinates\r\n  map.flyTo({ center: [lng, lat], zoom, speed });\r\n  return [lng, lat]\r\n}","import { useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { gradients } from '../rest/colors';\r\nimport { TEXT } from '../rest/lang';\r\nimport { setModal } from '../store/app';\r\n\r\nexport const Rater = ({ onSubmit }) => {\r\n  const { theme, isLogged } = useSelector(s => s.app)\r\n  const gradient = gradients[theme]\r\n  const dispatch = useDispatch()\r\n\r\n  const [hover, setHover] = useState(0);\r\n  const [rating, setRating] = useState(0);\r\n  const [comment, setComment] = useState('');\r\n\r\n  function onClick() {\r\n    setRating(hover)\r\n  }\r\n  function onInput(e) {\r\n    setComment(e.target.value)\r\n  }\r\n  function onSub() {\r\n    if (Number(rating) === 0) return setModal(dispatch, {\r\n      message: TEXT.rateZeroModal,\r\n      acceptAction: submitAction,\r\n    })\r\n    submitAction()\r\n  }\r\n  function submitAction() {\r\n    setHover(0)\r\n    onSubmit(rating, comment)\r\n  }\r\n  function onMouseEnter(e) {\r\n    setHover(Number(e.target.name))\r\n  }\r\n  function onMouseLeave() {\r\n    setHover(rating)\r\n  }\r\n\r\n  // TODO make stars with rating gradient\r\n  return (\r\n    <div className=\"rater\">\r\n\r\n      <div className=\"stars\">\r\n        <h5 className=\"starRating\">{TEXT.rating} :</h5> <span className=\"hoverValue mp-dark\">{hover + 1 ? hover : 0}</span>\r\n        <br />\r\n        {[...Array(5)].map((star, index) => {\r\n          index += 1;\r\n          return (\r\n            <button\r\n              type=\"button\"\r\n              key={index}\r\n              name={index}\r\n              className={index <= (hover || rating) ? \"mp-accent starButton\" : \"mp-secondary starButton\"}\r\n              onClick={onClick}\r\n              onMouseEnter={onMouseEnter}\r\n              onMouseLeave={onMouseLeave}\r\n              style={index <= (hover || rating) ? { color: gradient[hover] } : { color: gradient[0] }}\r\n            >\r\n              <span className=\"star\">&#9733;</span>\r\n            </button>\r\n          );\r\n        })}\r\n\r\n      </div>\r\n\r\n      <textarea\r\n        name=\"comment\" cols=\"25\" rows=\"2\"\r\n        value={comment} onInput={onInput}\r\n        className=\"raterComment\"\r\n        placeholder={TEXT.commentPlacehol}\r\n      />\r\n\r\n      <div className=\"raterBtnContainer\">\r\n        <button type=\"button\" onClick={onSub}>{TEXT.send}</button>\r\n        {!isLogged &&\r\n          <div className=\"subtitle\">{TEXT.asAnonius}</div>\r\n        }\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect } from 'react'\r\n// import { useSelector } from 'react-redux';\r\n// import { gradients } from '../rest/colors';\r\nimport { TEXT } from \"../rest/lang\";\r\n\r\nexport const Featurer = ({ feature, name, setName }) => {\r\n\r\n  // const { theme } = useSelector(s => s.app)\r\n\r\n  // function color() {\r\n  //   if (!feature?.properties?.rating) return gradients[theme][0]\r\n  //   for (let i = 0; i < gradients[theme].length; i++) {\r\n  //     if (feature.properties.rating <= i) return gradients[theme][i]\r\n  //   }\r\n  // }\r\n\r\n  useEffect(() => {\r\n    if (feature?.name) setName(feature.properties.name)\r\n\r\n    console.log('%c⧭', 'color: #d0bfff', feature);\r\n  }, [feature, setName])\r\n\r\n  if (!feature?.source) {\r\n    console.log('wtf feature', feature);\r\n    return null\r\n  }\r\n  // Case rated before\r\n  if (feature.source === 'ratedFeaturesSource') return (\r\n    <div className=\"featurer\">\r\n      <p className=\"rateAmount\">\r\n        {TEXT.placeAmountPrefix + ' ' + feature.properties.amount + ' '}\r\n        {String(feature.properties.amount).endsWith('1') ? TEXT.placeAmountNumberEnds1 : TEXT.placeAmountEndsMultiple}\r\n      </p>\r\n      <h5 className=\"rateValue\">\r\n        {TEXT.placeRatingPrefix}:\r\n        <span className=\"rateNumber\"> {feature.properties.rating}</span>\r\n      </h5>\r\n      {feature.properties.name ?\r\n        <div className=\"featureNameWrap\">\r\n          <p className=\"featureName mp-bg-dark mp-border-primary mp-light\">{feature.properties.name}</p>\r\n        </div>\r\n        : <></>}\r\n    </div>\r\n  )\r\n  // Case created  \r\n  function onInput(e) {\r\n    setName(e.target.value)\r\n    feature.properties.name = e.target.value\r\n  }\r\n  if (feature.source === 'createdPoly') return (\r\n    <div className=\"featurer\">\r\n      <p className=\"featurerGreetings\">\r\n        {TEXT.newFeature}\r\n      </p>\r\n\r\n      <div className=\"featureNameWrap\">\r\n        <input\r\n          type=\"text\" value={name} onInput={onInput}\r\n          placeholder={TEXT.newFeaturePHolder} title={TEXT.newFeaturePHolder}\r\n          className=\"featureName mp-bg-counter mp-border-counter  mp-primary\"\r\n        />\r\n      </div>\r\n      {/* {feature.properties.name ?\r\n        <div className=\"featureNameWrap\">\r\n          <p className=\"featureName mp-bg-counter mp-border-counter  mp-primary\">{feature.properties.name}</p>\r\n        </div>\r\n        : <div>\r\n          <input type=\"text\" value={name} onInput={onInput} placeholder={'enter name or name'}/>\r\n        </div>} */}\r\n    </div>\r\n  )\r\n  // Case new feature\r\n  return (\r\n    <div className=\"featurer\">\r\n      <p className=\"featurerGreetings\">\r\n        {TEXT.firstTimeRate}\r\n      </p>\r\n      {feature.properties.name ?\r\n        <div className=\"featureNameWrap\">\r\n          <p className=\"featureName mp-bg-counter mp-border-primary  mp-primary\">{feature.properties.name}</p>\r\n        </div>\r\n        : <></>}\r\n    </div>\r\n  )\r\n}\r\n","export function formatGeodata(geometry) {\r\n  // Treat everyone as multiPoly\r\n  let multiPoly\r\n  if (geometry.type === 'Polygon') {\r\n    multiPoly = [geometry.coordinates]\r\n  }\r\n  else multiPoly = geometry.coordinates\r\n\r\n  let north = -90\r\n  let east = -180\r\n  let south = 90\r\n  let west = 180\r\n\r\n  // 'MULTIPOLYGON('\r\n  const polyPoints = []\r\n\r\n  multiPoly.forEach((polyCoords) => {\r\n    polyPoints.push( polygonMapper(polyCoords))\r\n  })\r\n  const multiFormatted = 'MULTIPOLYGON(' + polyPoints.join(', ') + ')'\r\n\r\n  function polygonMapper(polyCoords) {\r\n    const polyArray = []\r\n    polyCoords.forEach((coordinates, shapeIndex) => {\r\n      polyArray.push('(')\r\n      // Map through each poly entity\r\n      coordinates.forEach(([lon, lat], i) => {\r\n        //    Find medium lon and lat\r\n        // Lesser longitude = more western\r\n        if (lon < west) west = lon\r\n        if (lon > east) east = lon\r\n        // Lesser latitude - more southern\r\n        if (lat > north) north = lat\r\n        if (lat < south) south = lat\r\n\r\n        // Store polydata\r\n        polyArray[shapeIndex] += (i ? ', ' : '') + String(lon) + ' ' + String(lat)\r\n      })\r\n      polyArray[shapeIndex] += ')'\r\n    })\r\n\r\n    return '(' + polyArray.join(',') + ')'\r\n  }\r\n\r\n\r\n  return [\r\n    [east, north],\r\n    [west, south],\r\n    multiFormatted\r\n  ]\r\n}\r\n","import { useSelector } from 'react-redux'\r\nimport { gradients } from '../rest/colors'\r\nimport { TEXT } from '../rest/lang'\r\n\r\nexport const Legend = () => {\r\n  const theme = useSelector(s => s.app.theme)\r\n  const gradient = gradients[theme]\r\n\r\n  return (\r\n    <div className=\"mapLegend mp-bg-light mp-border-secondary mp-shadow-light\">\r\n      <div className=\"ratingLegend\">\r\n        <div className=\"ratingDescription\">\r\n          <span>{TEXT.worstRating}</span>\r\n          <span></span>\r\n          <span></span>\r\n          <span></span>\r\n          <span>{TEXT.bestRating}</span>\r\n        </div>\r\n        <div className=\"ratingUnitsWrap\">\r\n          {gradient.map((color, i) => {\r\n            return (\r\n              <div className=\"ratingUnit\" key={color + i}>\r\n                <span className=\"ratingColor\" style={{ backgroundColor: color }}></span>\r\n              </div>\r\n            )\r\n          })}\r\n        </div>\r\n        <div className=\"ratingGradientWrap\">\r\n          <div className=\"ratingGradient\" style={{ background: `linear-gradient(90deg, ${gradient[0]}, ${gradient[3]}, ${gradient[5]})` }}></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Link } from 'react-router-dom';\r\nimport { deleteReview, getReviews } from '../requests/map';\r\nimport { TEXT } from '../rest/lang';\r\nimport { expandComments, setModal, setToast, shrinkComments } from '../store/app';\r\n\r\nexport const Reviews = ({ feature, updateLayers, setGeoData }) => {\r\n  const dispatch = useDispatch()\r\n  const { reviewsShown } = useSelector(state => state.app)\r\n  const userId = useSelector(state => state.user.id)\r\n\r\n  const [reviews, setReviews] = useState([])\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      if (feature?.source !== 'ratedFeaturesSource') return (null)\r\n\r\n      const res = await getReviews(feature.id)\r\n      if (res.status !== 'OK') return setToast(dispatch, { message: TEXT.requestError });\r\n      setReviews(res.data)\r\n    })()\r\n    // Cleanup. Do we need it?\r\n    return () => {\r\n      setReviews([])\r\n    }\r\n    /* eslint-disable */\r\n  }, [feature?.source, feature?.id])\r\n  /* eslint-enable */\r\n\r\n  function onClick() {\r\n    reviewsShown ? shrinkComments(dispatch) : expandComments(dispatch)\r\n  }\r\n\r\n  function deleteClick(e) {\r\n    const timestamp = e.target.attributes.timestamp.value\r\n    const place = {\r\n      rating: feature.properties.rating,\r\n      amount: feature.properties.amount,\r\n      grade: e.target.attributes.grade.value,\r\n      id: feature.id\r\n    }\r\n\r\n    setModal(dispatch, {\r\n      message: TEXT.removeComment + '?',\r\n      async acceptAction() {\r\n        const res = await deleteReview(timestamp, place)\r\n\r\n        if (res.status !== 'OK') return setToast(dispatch, { message: TEXT.requestError });\r\n        setReviews(reviews.filter(rev => rev.timestamp + rev.author !== timestamp + userId))\r\n        feature.properties.rating = (place.amount * place.rating - place.grade) / (place.amount - 1)\r\n        feature.properties.amount -= 1\r\n        setGeoData(geoData => {\r\n\r\n          // Mutate geoData\r\n          for (let i = 0; i < geoData.length; i++) {\r\n            if (geoData[i].id === feature.id) {\r\n              const { amount, rating } = feature.properties\r\n              geoData[i].properties = {\r\n                rating: +((amount * rating - place.grade) / (amount - 1)).toFixed(5),  //toFixed - 5 numbers after point\r\n                amount: amount - 1\r\n              }\r\n              break;\r\n            }\r\n          } return geoData\r\n        })\r\n        updateLayers()\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  if (feature?.source !== 'ratedFeaturesSource') return (null)\r\n  return (\r\n    <div className={`reviewsContainer ${reviewsShown ? 'expanded' : 'shrinked'}`}>\r\n      {reviews.length ? reviews.map(review => {\r\n        console.log('%c⧭', 'color: #d90000', review);\r\n        if (!review.name) review.name = TEXT.anonimus\r\n        return (\r\n          <div className=\"reviewWrap mp-border-secondary mp-shadow-light\" key={review.author + review.timestamp}>\r\n            <Link to={\"/friends/user/\" + review.author}>\r\n              <div className=\"authorLogo mp-bg-primary\">\r\n                <span className=\"mp-dark\" title={review.login}>{String(review.name)?.[0]?.toUpperCase()}</span>\r\n              </div>\r\n            </Link>\r\n            <div className=\"reviewBody\">\r\n              <p className=\"author mp-primary\">{review.name}</p>\r\n              <div className=\"reviewDate mp-secondary\">\r\n                {new Date(review.timestamp).toLocaleDateString()}\r\n                {Boolean(review.author !== 'anonimus' && review.author === userId) &&\r\n                  <label\r\n                    onClick={deleteClick} className=\"deleteComment cursor-pointer\" timestamp={review.timestamp} grade={review.grade}\r\n                  > ✕\r\n                  </label>\r\n                }\r\n              </div>\r\n              <div className=\"reviewRating\">{review.grade}/5\r\n                <span className=\"reviewStars stars\">\r\n                  {[...Array(5)].map((star, index) => {\r\n                    index += 1;\r\n                    return (\r\n                      <span key={index}\r\n                        className={index <= (review.grade) ? \"mp-accent starButton\" : \"mp-secondary starButton\"}\r\n                      >&#9733;\r\n                      </span>\r\n                    );\r\n                  })}\r\n                </span>\r\n              </div>\r\n              {Boolean(review.comment) && <div className=\"reviewComment \">{review.comment}</div>}\r\n            </div>\r\n          </div>\r\n        )\r\n      }) :\r\n        <div>{TEXT.noreviews}</div>\r\n      }\r\n\r\n      <div className=\"skipperContainer\">\r\n        <div className=\"skipper mp-bg-light mp-border-secondary\" onClick={onClick}>\r\n          {reviewsShown ?\r\n            <span className=\"mp-secondary\">&#8613;</span> :\r\n            <span className=\"mp-secondary\">&#8615;</span>\r\n          }\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\r\nimport { MapArea } from './Map'\r\nimport { Rater } from './Rater'\r\nimport { Featurer } from './Featurer';\r\nimport { formatGeodata } from './formatGeodata'\r\nimport { postInitReview, postNextReview } from '../requests/map';\r\nimport './Maps.css'\r\nimport { Legend } from './Legend';\r\nimport { Reviews } from './Reviews';\r\nimport { getLayoutCoords } from '../rest/helperFuncs';\r\nimport { friendModeId, setToast, showMain } from '../store/app';\r\nimport { TEXT } from '../rest/lang';\r\n\r\n\r\nexport const Main = () => {\r\n  // Store\r\n  const user = useSelector(state => state.user)\r\n  const app = useSelector(state => state.app)\r\n  const dispatch = useDispatch()\r\n\r\n  const [feature, setFeature] = useState(null);\r\n  // Featurer\r\n  const [name, setName] = useState('')\r\n  // Map\r\n  const [geoData, setGeoData] = useState(null)\r\n  const [featureTrigger, setFeatureTrigger] = useState(0);\r\n  const [mapTrigger, setMapTrigger] = useState(0);\r\n  function updateLayers() {\r\n    setFeatureTrigger(featureTrigger + 1)\r\n  }\r\n\r\n  function resetRater() {\r\n    setName('')\r\n    setFeature(null)\r\n  }\r\n\r\n  async function onSubmit(rating, comment) {\r\n    // Calculations\r\n    const [northEastest, southWestest, polyString] = formatGeodata(feature.geometry)\r\n    const tempBox = new mapboxgl.LngLatBounds(northEastest, southWestest)\r\n    const { lng, lat } = tempBox.getCenter()\r\n\r\n\r\n    // Data to store\r\n    const review = {\r\n      comment,\r\n      grade: rating,\r\n      targetId: feature.id,\r\n    }\r\n    const place = {\r\n      lng, lat,\r\n      id: feature.id,\r\n      name: feature.properties.name || \"\",\r\n      polyString\r\n    }\r\n    const { x, y } = getLayoutCoords(lng, lat, 16)\r\n    place.x = x\r\n    place.y = y\r\n    \r\n    // Go out from watchMode\r\n    friendModeId(dispatch, null)\r\n\r\n\r\n    // Case next review\r\n    if (feature.source === 'ratedFeaturesSource') {\r\n      const res = await postNextReview({ user: user.id, review, place: { ...feature.properties, id: feature.id } })\r\n      if (res.status !== 'OK') return setToast(dispatch, { message: TEXT.requestError })\r\n      // Mutate geoData\r\n      for (let i = 0; i < geoData.length; i++) {\r\n        if (geoData[i].id === feature.id) {\r\n          const { amount, rating } = feature.properties\r\n          geoData[i].properties = {\r\n            rating: +((amount * rating + review.grade) / (amount + 1)).toFixed(5),  //toFixed - 5 numbers after point\r\n            amount: amount + 1\r\n          }\r\n          break;\r\n        }\r\n      } setGeoData(geoData)\r\n      updateLayers()\r\n      return resetRater()\r\n    }\r\n\r\n\r\n    // Case first time review\r\n    // console.log(user.id, review, place);\r\n    const res = await postInitReview({ user: user.id, review, place })\r\n    if (res.status !== 'OK') return setToast(dispatch, { message: TEXT.requestError })\r\n\r\n    setGeoData([...geoData, {\r\n      type: 'Feature',\r\n      properties: { rating, name, amount: 1 },\r\n      id: feature.id,\r\n      // geometry: {...feature.geometry}\r\n      geometry: feature.geometry\r\n    }])\r\n    updateLayers()\r\n\r\n    if (feature.source === 'createdPoly') setMapTrigger(mapTrigger + 1)\r\n    // Restore init features\r\n    resetRater()\r\n  }\r\n\r\n  useEffect(() => {\r\n    showMain(dispatch)    \r\n    // eslint-disable-next-line\r\n  }, [])\r\n\r\n  return (\r\n    <div className={app.mapHidden ? \"hidden\" : \"mainWrapper\"}>\r\n      <MapArea\r\n        feature={feature} setFeature={setFeature}\r\n        resetRater={resetRater}\r\n        geoData={geoData} setGeoData={setGeoData}\r\n        featureTrigger={featureTrigger}\r\n        key={mapTrigger}\r\n      />\r\n      <Legend />\r\n      {feature &&\r\n        <div className=\"featureContainer mp-bg-light mp-border-secondary\">\r\n          <Featurer feature={feature} name={name} setName={setName} />\r\n          <Rater onSubmit={onSubmit} />\r\n          <Reviews feature={feature} updateLayers={updateLayers} setGeoData={setGeoData}/>\r\n          <div className=\"closeFeature\" onClick={resetRater}>&#10005;</div>\r\n        </div>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n","import { api, requsetMaker } from './config'\r\n\r\nexport async function loginWithCreds(creds) {\r\n  const f = requsetMaker('POST', 'auth', 'login', { ...creds }, true)\r\n  return await f()\r\n}\r\n\r\nexport const refresh = requsetMaker('GET', 'auth', 'refresh', null, true)\r\n\r\nexport const logout = requsetMaker('GET', 'auth', 'logout', null, true)\r\n\r\nexport async function loginbyGoogle(creds, token) {\r\n  const options = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': 'Bearer ' + token\r\n    },\r\n    body: JSON.stringify({ ...creds }),\r\n    credentials: 'include'\r\n  }\r\n  try {\r\n    const response = await fetch(api + 'auth/glogin', options)\r\n    const res = await response.json()\r\n    return res\r\n  } catch (err) {\r\n    return err\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nexport const Responser = ({ message = '', setMessage, color = 'accent', title = '' }) => {\r\n  function onClick() {\r\n    setMessage('')\r\n  }\r\n\r\n  if (!message) return null\r\n\r\n  const cn = `responser mp-${color} mp-border-${color}`\r\n\r\n  return (\r\n    <div className={cn}>\r\n      <div className=\"header\">\r\n        <h6>{title}</h6>\r\n        <div className={`close-cross cursor-pointer mp-${color}`} onClick={onClick}>&#10006;</div>\r\n      \r\n      </div>\r\n      <p>{message}</p>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Link, useHistory, useLocation } from 'react-router-dom';\r\nimport { loginbyGoogle, loginWithCreds, logout } from '../requests/auth';\r\nimport { googleCreds } from '../rest/config';\r\nimport { TEXT } from '../rest/lang';\r\nimport { Responser } from '../rest/Responser';\r\nimport { closeModal, setToast } from '../store/app';\r\nimport { logIntoApp, logOutOfApp } from '../store/user';\r\nimport { getFriendsInfo } from '../rest/helperFuncs'\r\n\r\nexport const Login = () => {\r\n  const dispatch = useDispatch()\r\n  const history = useHistory()\r\n  const user = useSelector(state => state.user)\r\n  const app = useSelector(state => state.app)\r\n  const loc = useLocation().pathname\r\n\r\n  const [login, setLogin] = useState('')\r\n  const [pword, setPword] = useState('')\r\n  const [msg, setMsg] = useState('')\r\n\r\n  useEffect(() => {\r\n    const { gapi } = window\r\n    if (!gapi) return setToast(dispatch, {\r\n      message: TEXT.networkError\r\n    })\r\n\r\n    gapi.load('auth2', () => {\r\n      gapi.auth2.init().then((auth) => {\r\n        auth.signOut().then(() => {\r\n          gapi.signin2.render('google-signin-button', {\r\n            width: 200,\r\n            height: 32,\r\n            longtitle: true,\r\n            onsuccess: onOAuth,\r\n            onfailure: onFail,\r\n            theme: (app.theme === 'dark' || app.theme === 'blueprint') ? 'dark' : 'white'\r\n          });\r\n        });\r\n      });\r\n\r\n    });\r\n    // eslint-disable-next-line\r\n  }, [])\r\n\r\n\r\n  function onInput(e) {\r\n    setLogin(e.target.value)\r\n  }\r\n  function onPword(e) {\r\n    setPword(e.target.value)\r\n  }\r\n  async function onSubmit() {\r\n    setMsg(TEXT.loading + '...')\r\n    const res = await loginWithCreds({ login, pword })\r\n    if (res.status === 'WRONG') {\r\n      return setMsg(TEXT.wrongAuth)\r\n    }\r\n    if (res.status === 'OK') {\r\n      closeModal(dispatch)\r\n      setToast(dispatch, {\r\n        message: TEXT.greetings + ', ' + res.data.name,\r\n        status: 'complete',\r\n        title: null\r\n      })\r\n      setMsg('')\r\n      await getFriendsInfo(dispatch)\r\n      history.push('/')\r\n      return logIntoApp(dispatch, res.data)\r\n    }\r\n    setMsg(TEXT.errorReg + ', ' + TEXT.errCode + ': ' + (res.msg || res))\r\n\r\n    // window.localStorage.setItem('usernameTemp', login)\r\n  }\r\n  async function logOut() {\r\n    const res = await logout()\r\n    if (res.status === 'OK') {\r\n      setToast(dispatch, {\r\n        message: TEXT.farewell + ', ' + user.name,\r\n        status: 'complete',\r\n        title: null\r\n      })\r\n      setLogin('')\r\n      setPword('')\r\n      setMsg('')\r\n      return logOutOfApp(dispatch)\r\n    }\r\n    setMsg(TEXT.errorReg + ', ' + TEXT.errCode + ': ' + (res.msg || res))\r\n  }\r\n\r\n\r\n  async function onOAuth(googleUser) {\r\n    var profile = googleUser.getBasicProfile();\r\n    // console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.\r\n    // console.log('Name: ' + profile.getName());\r\n    // console.log('Image URL: ' + profile.getImageUrl());\r\n    // console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.\r\n    const data = {\r\n      name: profile.getName(),\r\n      avatar: profile.getImageUrl(),\r\n      gmail: profile.getEmail()\r\n    }\r\n    const res = await loginbyGoogle(data, googleUser.getAuthResponse().id_token)\r\n\r\n    if (res.status === 'FIRSTTIME') {\r\n      googleCreds.token = googleUser.getAuthResponse().id_token\r\n      googleCreds.name = res.data.name\r\n      googleCreds.login = res.data.login\r\n      if (!res.data.login) googleCreds.occupiedLogin = profile.getEmail().split('@')[0]\r\n      googleCreds.avatar = res.data.avatar\r\n      googleCreds.id = profile.getId()\r\n      closeModal(dispatch)\r\n      return history.push('/googleConfirm')\r\n    }\r\n    if (res.status === 'OK') {\r\n      closeModal(dispatch)\r\n      setToast(dispatch, {\r\n        message: TEXT.greetings + ', ' + res.data.name,\r\n        status: 'complete',\r\n        title: null\r\n      })\r\n      setMsg('')\r\n      await getFriendsInfo(dispatch)\r\n      history.push('/')\r\n      return logIntoApp(dispatch, res.data)\r\n    }\r\n    setMsg(TEXT.errorReg + ', ' + TEXT.errCode + ': ' + (res.msg || res))\r\n  }\r\n  function onFail(a) {\r\n    console.log('%c⧭ failed', 'color: #00a3cc', a);\r\n    setMsg(TEXT.errorReg + ', ' + TEXT.errCode + ': ' + JSON.stringify(a))\r\n  }\r\n\r\n  function onInitReg() {\r\n    closeModal(dispatch)\r\n  }\r\n\r\n  return (\r\n    <div>{\r\n      app.isLogged ? <div>\r\n        <h4>{TEXT.greetings}, {user.name}</h4>\r\n\r\n        <button className=\"primary\" onClick={logOut}>{TEXT.logout}</button>\r\n      </div>\r\n        :\r\n        <div>\r\n          <div className={loc !== '/auth' ? 'login-form login-form-bordered mp-border-secondary' : 'login-form'}>\r\n            <label htmlFor=\"name\">{TEXT.yourLogin}:</label>\r\n            <input type=\"text\" name=\"login\" value={login} onInput={onInput} autoFocus />\r\n            <br />\r\n            <label htmlFor=\"pword\">{TEXT.yourPword}:</label>\r\n            <input type=\"password\" name=\"pword\" value={pword} onInput={onPword} />\r\n\r\n            <Responser message={msg} setMessage={setMsg} />\r\n\r\n            <button className=\"primary mp-border-accent loginBtn\" onClick={onSubmit}>{TEXT.confirm}</button>\r\n            {/* <button className=\"mp-border-secondary oauthBtn\" onClick={oauth}>{'Google'}</button> */}\r\n            <div id=\"google-signin-button\"\r\n              className=\"google-signin-button g-signin2 google-oauthBtn\" data-onsuccess=\"onSignIn\"></div>\r\n          </div>\r\n          {loc !== '/auth' &&\r\n            <div className=\"align-center\">\r\n              <Link to=\"/auth?reg=true\" onClick={onInitReg}>\r\n                <button className=\"button\">{TEXT.register}</button>\r\n              </Link>\r\n            </div>}\r\n\r\n        </div>\r\n    }\r\n    </div>\r\n  )\r\n}\r\n","import { requsetMaker } from \"./config\"\r\n\r\nexport async function registerUser(data) {\r\n  const f = requsetMaker('POST', 'users', 'register', { ...data }, true)\r\n  return await f()\r\n}\r\n\r\nexport async function registerGUser(data) {\r\n  const f = requsetMaker('POST', 'users', 'gregister', { ...data }, true)\r\n  return await f()\r\n}\r\n\r\nexport async function updateUser(data) {\r\n  const f = requsetMaker('POST', 'users', 'update', { ...data }, true)\r\n  return await f()\r\n}\r\n\r\nexport async function updateUserPword(data) {\r\n  const f = requsetMaker('POST', 'users', 'updatePword', { ...data }, true)\r\n  return await f()\r\n}\r\n\r\nexport async function setLanguage(lang) {\r\n  const f = requsetMaker('GET', 'settings', 'setLang', null, true, 'lang=' + lang)\r\n  return await f()\r\n}\r\n","import { useRef, useState } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { registerUser } from '../requests/users'\r\nimport { TEXT } from '../rest/lang'\r\nimport { Responser } from '../rest/Responser'\r\nimport { logIntoApp } from '../store/user'\r\nconst initCreds = { login: '', pword: '', name: '', question: TEXT.secretExample, answer: '' }\r\n\r\nexport const Register = () => {\r\n  const dispatch = useDispatch()\r\n  const history = useHistory()\r\n\r\n  const [creds, setCreds] = useState(initCreds)\r\n  const [msg, setMsg] = useState('')\r\n  const ref = useRef(null)\r\n  const [replica, setReplica] = useState(false);\r\n\r\n  function onInput(e) {\r\n    setCreds({ ...creds, [e.target.name]: e.target.value })\r\n  }\r\n  function onReplica() {\r\n    setReplica(false)\r\n    setMsg(TEXT.secretReplica2)\r\n    ref.current.focus()\r\n  }\r\n\r\n  async function onSubmit() {\r\n    if (!creds.login || !creds.pword) return setMsg(TEXT.fillRequiredFields)\r\n    if (creds.question && !creds.answer) {\r\n      if (creds.question === TEXT.secretExample) setReplica(true)\r\n      ref.current.focus()\r\n      return setMsg(TEXT.secretValidation)\r\n    }\r\n\r\n    // Validation\r\n    if (creds.question?.length > 300) return setMsg((TEXT.field + ' ' + TEXT.secretQuestion + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.answer?.length > 255) return setMsg((TEXT.field + ' ' + TEXT.secterAnswer + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.login.length > 50) return setMsg((TEXT.field + ' ' + TEXT.login + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.pword.length > 50) return setMsg((TEXT.field + ' ' + TEXT.password + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.name.length > 140) return setMsg((TEXT.field + ' ' + TEXT.userName + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n\r\n\r\n    const res = await registerUser(creds)\r\n    if (res.status === 'OK') {\r\n      setMsg(TEXT.successfullReg)\r\n      logIntoApp(dispatch, res.data)\r\n      setCreds(initCreds)\r\n      history.push('/')\r\n    }\r\n    else if (res.status === 'EXISTING') {\r\n      return setMsg(TEXT.loginOccupied + ' - ' + creds.login)\r\n    }\r\n    else if (res.status === 'BANEDPWORD') {\r\n      return setMsg(TEXT.bannedPwod + ' - ' + creds.pword)\r\n    }\r\n    else {\r\n      setMsg(TEXT.errorReg + ', ' + TEXT.errCode + ': ' + (res.msg || res))\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"register-form\">\r\n        <h4>{TEXT.register}</h4>\r\n        <label htmlFor=\"login\">{TEXT.login}:</label>\r\n        <input type=\"text\" name=\"login\" value={creds.login} onInput={onInput} autoFocus required />\r\n        <br />\r\n        <label htmlFor=\"name\">{TEXT.userName}:</label>\r\n        <input type=\"text\" name=\"name\" value={creds.name} onInput={onInput} required />\r\n        <br />\r\n        <label htmlFor=\"pword\">{TEXT.password}:</label>\r\n        <input type=\"password\" name=\"pword\" value={creds.pword} onInput={onInput} required />\r\n        <br />\r\n        <br />\r\n        <label htmlFor=\"question\">{TEXT.secretQuestion}:</label>\r\n        <br />\r\n        <textarea type=\"text\" name=\"question\" value={creds.question} onInput={onInput} autoComplete=\"false\"/>\r\n        <p className=\"little-hint\">{TEXT.secretHint}</p>\r\n\r\n        <label htmlFor=\"answer\">{TEXT.secterAnswer}:</label>\r\n        <input type=\"text\" name=\"answer\" value={creds.answer} onInput={onInput} required={Boolean(creds.question)} ref={ref} autoComplete=\"false\" />\r\n        <div className=\"register-responser\">\r\n          <Responser message={msg} setMessage={setMsg} />\r\n        </div>\r\n        {replica &&\r\n          <button className=\"btn-replica mp-border-counter mp-primary-hover\" onClick={onReplica}>{TEXT.secretReplica}</button>}\r\n        <button className=\"mp-border-accent\" type=\"button\" onClick={onSubmit}>{TEXT.submit}</button>\r\n      </div>\r\n\r\n    </div>\r\n  )\r\n}\r\n","import { useState } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { useEffect } from \"react\";\r\nimport { hideMain } from \"../store/app\";\r\nimport { TEXT } from '../rest/lang'\r\nimport { Login } from './Login'\r\nimport { Register } from './Register'\r\nimport './Auth.css'\r\nimport { useLocation } from 'react-router-dom';\r\n\r\nexport const AuthMain = () => {\r\n  const dispatch = useDispatch()\r\n  const reg = new URLSearchParams(useLocation().search).get('reg')\r\n  \r\n  const [isLogging, setIsLogging] = useState(true)\r\n  \r\n  useEffect(() => {\r\n    hideMain(dispatch)    \r\n    if (reg) setIsLogging(false)\r\n    // eslint-disable-next-line\r\n  }, [])\r\n  \r\n  return (\r\n    <div className=\"auth-container relative\">\r\n      <div className=\"absolute center auth-subcontainer\">\r\n\r\n      {isLogging ? <h3 className=\"align-center\">{TEXT.login}</h3> : null}\r\n      {/* TODO uptop label is good when form is borderless, else put header inside borders like in reg component */}\r\n\r\n        <div className=\"auth-action-wrap mp-border-secondary\">\r\n          {isLogging ? <Login /> : <Register />}\r\n        </div>\r\n        <div className=\"align-center\">\r\n          {!isLogging ?\r\n            <button className=\"small\" onClick={() => setIsLogging(true)}>{TEXT.login}</button> :\r\n            <button className=\"small\" onClick={() => setIsLogging(false)}>{TEXT.register}</button>\r\n          }\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n/* eslint-disable */\r\n","import { useSelector } from 'react-redux'\r\nimport { Link } from 'react-router-dom'\r\nimport { TEXT } from '../../rest/lang'\r\nimport { navStates } from '../LeftMenu'\r\n\r\nexport const DefNav = ({ setNavState, hideSelf }) => {\r\n\r\n  const user = useSelector(state => state.user)\r\n  const app = useSelector(state => state.app)\r\n\r\n  function hideMainMenu() {\r\n    hideSelf()\r\n  }\r\n  function pickTheme() {\r\n    setNavState(navStates.theme)\r\n  }\r\n  function pickLang() {\r\n    setNavState(navStates.language)\r\n  }\r\n\r\n\r\n  return (\r\n    <div className=\"left-menu-container\">\r\n      <div className=\"menu-user\">\r\n        <div className=\"menu-avatar mp-bg-counter\">\r\n          <div className=\"letter mp-light\">{user.name?.[0] || \"?\"}</div>\r\n        </div>\r\n        <div className=\"menu-user-subcontainer\">\r\n          <div className=\"menu-username\">{user.name || 'no name'}</div>\r\n          <div className=\"menu-userlevel\">{TEXT.level}: <span className=\"mp-accent\">{user.level}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div>\r\n        {app.isLogged ?\r\n          <Link to=\"/editProfile\" onClick={hideMainMenu} className=\"left-menu-item mp-dark\"> {TEXT.profile}</Link> :\r\n          <Link to=\"/auth\" onClick={hideMainMenu} className=\"left-menu-item mp-dark\"> {TEXT.login}</Link>\r\n        }\r\n      </div>\r\n      <div onClick={pickTheme} className=\"left-menu-item mp-accent-hover pick-theme-item\">{TEXT.theme}\r\n        <label className=\"little-hint\">({TEXT[app.theme]})</label>\r\n      </div>\r\n      <div onClick={pickLang} className=\"left-menu-item mp-accent-hover pick-theme-item\">{TEXT.language}</div>\r\n      <Link to=\"/friends\" onClick={hideMainMenu} className=\"left-menu-item mp-dark\">{TEXT.friends}\r\n        {Boolean(user.requests.length) &&\r\n          <span className=\"mp-accent\">{' (' + user.requests.length + ')'}</span>\r\n        }\r\n      </Link>\r\n      <div className=\"readonly\">{TEXT.routes}</div>\r\n      <div className=\"readonly\">{TEXT.aboutUs}</div>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { useDispatch } from 'react-redux';\r\nimport { setLanguage } from '../../requests/users';\r\nimport { appLanguages } from '../../rest/config';\r\nimport { TEXT } from '../../rest/lang';\r\nimport { setToast } from '../../store/app';\r\nimport { navStates } from '../LeftMenu';\r\n\r\nexport const LangNav = ({ setNavState }) => {\r\n  const d = useDispatch()\r\n\r\n  const [lang, setLang] = useState();\r\n\r\n  async function onClick(e) {\r\n    const lang = e.target.attributes.name.value\r\n    const res = await setLanguage(lang)\r\n    if (res.status === 'OK') return window.location.reload();\r\n    setToast(d, {\r\n      message: JSON.stringify(res),\r\n      title: TEXT.error,\r\n      status: 'error',\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    setLang(document.documentElement.lang)\r\n  }, [])\r\n\r\n  function onBack() {\r\n    setNavState(navStates.default)\r\n  }\r\n\r\n  return (\r\n    <div className=\"left-menu-container lang-nav\">\r\n\r\n      {/* Avatar area */}\r\n      <div className=\"menu-user theme-menu\">\r\n        <div onClick={onBack}\r\n          className=\"\r\n          menu-avatar cursor-pointer \r\n          mp-bg-accent-hover mp-light-hover\r\n          mp-bg-primary mp-light\r\n          transition\"\r\n        >\r\n          <div className=\"letter\" >{\"<\"}</div>\r\n        </div>\r\n        <div className=\"menu-user-subcontainer\">\r\n          <div className=\"menu-username\">{TEXT.pickLanguage}</div>\r\n          <div className=\"menu-userlevel\">{TEXT.language}: <span className=\"mp-accent\">{TEXT[lang]}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"pickTheme-container\">\r\n        {Object.keys(appLanguages).map((lng, i) => {\r\n          return (\r\n            <div\r\n              className={`\r\n              pickTheme-item mp-border-secondary mp-counter-hover transition-small\r\n              ${lng === lang ? ' current-theme mp-accent mp-border-accent events-none' : ''}\r\n              `}\r\n              name={lng}\r\n              onClick={onClick}\r\n              key={lng + i}\r\n            >\r\n              {TEXT[lng]}\r\n            </div>\r\n          )\r\n        })}\r\n      </div>\r\n\r\n    </div>\r\n  )\r\n}\r\n","import { projectPrefix } from \"../rest/config\";\r\n\r\nexport function getPreferences() {\r\n  const prefs = window.localStorage.getItem(projectPrefix + '/preferences')\r\n  if (prefs) return JSON.parse(prefs)\r\n  return null\r\n}\r\n\r\nexport function initLocalStorage() {\r\n  if (!getPreferences()) window.localStorage.setItem(projectPrefix + '/preferences', '{}')\r\n}\r\n\r\nexport function setPreference(preference, value) {\r\n  const prefs = getPreferences()\r\n  prefs[preference] = value\r\n  window.localStorage.setItem(projectPrefix + '/preferences', JSON.stringify(prefs))\r\n}","import { useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { setColors } from '../../rest/colors';\r\nimport { appThemes } from '../../rest/config';\r\nimport { TEXT } from '../../rest/lang';\r\nimport { switchTheme } from '../../store/app';\r\nimport { setPreference } from '../../store/localstorage';\r\nimport { navStates } from '../LeftMenu';\r\n\r\nexport const ThemeNav = ({ setNavState }) => {\r\n  const app = useSelector(state => state.app)\r\n  const dispatch = useDispatch()\r\n\r\n  const [themeN, setThemeN] = useState(appThemes.indexOf(app.theme));\r\n\r\n  function onClick(e) {\r\n    const themeNumber = e.target.attributes.name.value\r\n    setThemeN(themeNumber)\r\n    switchTheme(dispatch, appThemes[themeNumber])\r\n    setColors(appThemes[themeNumber])\r\n    setPreference('theme', appThemes[themeNumber])\r\n  }\r\n  function onBack() {\r\n    setNavState(navStates.default)\r\n  }\r\n\r\n  return (\r\n    <div className=\"left-menu-container\">\r\n\r\n      {/* Avatar area */}\r\n      <div className=\"menu-user theme-menu\">\r\n        <div onClick={onBack} className=\"\r\n          menu-avatar cursor-pointer \r\n          mp-bg-accent-hover mp-light-hover\r\n          mp-bg-primary mp-light\r\n          transition\"\r\n        >\r\n          <div className=\"letter\" >{\"<\"}</div>\r\n        </div>\r\n        <div className=\"menu-user-subcontainer\">\r\n          <div className=\"menu-username\">{TEXT.pickTheme}</div>\r\n          <div className=\"menu-userlevel\">{TEXT.theme}: <span className=\"mp-accent\">{TEXT[appThemes[themeN]]}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"pickTheme-container\">\r\n        {appThemes.map((theme, i) => {\r\n          return (\r\n            <div\r\n              className={`\r\n              pickTheme-item ${theme}-theme mp-border-secondary mp-counter-hover transition-small\r\n              ${+i === +themeN ? ' current-theme mp-accent mp-border-accent events-none' : ''}\r\n              `}\r\n              name={i}\r\n              onClick={onClick}\r\n              key={theme + String(themeN)}\r\n            >\r\n              {TEXT[theme]}\r\n            </div>\r\n          )\r\n        })}\r\n      </div>\r\n\r\n    </div>\r\n  )\r\n}\r\n","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgHamburger(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    fill: \"current\",\n    enableBackground: \"new 0 0 26 26\",\n    viewBox: \"0 0 26 26\",\n    xmlSpace: \"preserve\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M24.25,12.25H1.75C1.3359375,12.25,1,12.5859375,1,13s0.3359375,0.75,0.75,0.75h22.5   c0.4140625,0,0.75-0.3359375,0.75-0.75S24.6640625,12.25,24.25,12.25z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.75,7.75h22.5C24.6640625,7.75,25,7.4140625,25,7s-0.3359375-0.75-0.75-0.75H1.75   C1.3359375,6.25,1,6.5859375,1,7S1.3359375,7.75,1.75,7.75z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M24.25,18.25H1.75C1.3359375,18.25,1,18.5859375,1,19s0.3359375,0.75,0.75,0.75h22.5   c0.4140625,0,0.75-0.3359375,0.75-0.75S24.6640625,18.25,24.25,18.25z\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgHamburger);\nexport default __webpack_public_path__ + \"static/media/hamburger.64800f2d.svg\";\nexport { ForwardRef as ReactComponent };","import { useState } from \"react\"\r\nimport { DefNav } from \"./left/DefNav\"\r\nimport { LangNav } from \"./left/LangNav\"\r\nimport { ThemeNav } from \"./left/ThemeNav\"\r\nexport const navStates = { default: 'default', theme: 'theme', language: 'language' }\r\n\r\nexport const LeftMenu = ({ leftMenu, setLeftMenu }) => {\r\n  const [navState, setNavState] = useState(navStates.default) // also 'theme' and 'language'\r\n\r\n  function hideSelf() {\r\n    setLeftMenu(false)\r\n  }\r\n\r\n  const cn = \"mp-bg-light mp-border-secondary\"\r\n\r\n  return (\r\n    <div id=\"left-menu\" className={leftMenu ? \"active \" + cn : cn}>\r\n\r\n      {navState === navStates.default && <DefNav hideSelf={hideSelf} setNavState={setNavState} />}\r\n      {navState === navStates.theme && <ThemeNav hideSelf={hideSelf} setNavState={setNavState} />}\r\n      {navState === navStates.language && <LangNav setNavState={setNavState} />}\r\n\r\n      <div id=\"closeLeftAtBottom\">\r\n        <button onClick={hideSelf}>x</button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgWorld2(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    fill: \"current\",\n    enableBackground: \"new 0 0 800 800\",\n    id: \"Layer_1\",\n    viewBox: \"0 0 800 800\",\n    xmlSpace: \"preserve\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M417.1,176c9.6-2.1-1.1-22.4-9.6-24.5c-6.4-1.1-18.1,9.6-17.1,16C391.5,173.9,407.5,179.2,417.1,176z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M398.9,53.3C208,53.3,52.3,209.1,52.3,400S208,746.7,398.9,746.7S745.6,590.9,745.6,400S589.9,53.3,398.9,53.3z M681.6,400   c0,115.2-69.3,214.4-167.5,258.1c-12.8,2.1-30.9,3.2-68.3,3.2c-42.7-1.1-53.3,13.9-64,21.3c-10.7-1.1-22.4-2.1-33.1-4.3   c-2.1-1.1-4.3-2.1-6.4-3.2c-23.5-14.9-39.5-14.9-48-12.8c-103.5-41.6-177.1-144-177.1-262.4c0-41.6,8.5-80,24.5-115.2   c17.1,62.9-24.5,66.1-24.5,115.2c0,32,21.3,85.3,53.3,134.4c36.3,54.4,83.2,101.3,100.3,97.1c30.9-9.6-70.4-24.5-7.5-139.7   c62.9-116.3-82.1-39.5-103.5-198.4c-7.5-57.6,32-40.5,60.8-83.2c21.3-33.1,64-40.5,58.7-64c17.1-8.5,35.2-14.9,54.4-19.2   c-20.3,18.1-38.4,33.1,3.2,24.5c45.9-9.6,69.3-18.1,72.5-32c25.6,1.1,49.1,4.3,72.5,11.7c-17.1-2.1-49.1-2.1-50.1,20.3   c-2.1,30.9-6.4,42.7-21.3,45.9s-18.1,7.5-18.1,13.9c1.1,19.2,19.2,23.5,49.1,0c29.9-23.5,38.4,7.5,61.9,12.8   c23.5,5.3,20.3-23.5,39.5-16c19.2,7.5,42.7,49.1-17.1,44.8c-59.7-3.2-89.6-20.3-133.3,2.1c-61.9,30.9-51.2,122.7,13.9,121.6   c53.3,0,68.3,2.1,85.3,58.7S480,512,509.9,555.7c29.9,45.9,100.3-82.1,98.1-124.8s55.5-62.9,23.5-113.1   c-32-49.1,6.4-49.1,34.1-20.3C675.2,329.6,681.6,363.7,681.6,400z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M602.7,523.7c14.9,5.3,53.3-74.7,36.3-67.2C620.8,464,590.9,519.5,602.7,523.7z\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgWorld2);\nexport default __webpack_public_path__ + \"static/media/world2.a2a29618.svg\";\nexport { ForwardRef as ReactComponent };","import { useState } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport { TEXT } from '../rest/lang'\r\nimport { LeftMenu } from './LeftMenu'\r\nimport './Nav.css'\r\nimport { ReactComponent as Hamburger } from '../rest/svg/hamburger.svg';\r\nimport { ReactComponent as WoldIcon } from '../rest/svg/world2.svg';\r\n\r\nexport const NavMain = () => {\r\n  const app = useSelector(state => state.app)\r\n  const friends = useSelector(state => state.user.friends)\r\n  const [leftMenu, setLeftMenu] = useState(false)\r\n  const history = useHistory()\r\n\r\n  function showLeftMenu() {\r\n    setLeftMenu(true)\r\n  }\r\n  function backToMain() {\r\n    setLeftMenu(false)\r\n    history.push('/')\r\n  }\r\n  function initials() {\r\n    const friend = friends.find(friend => friend.id === app.friendModeId)\r\n    return friend.name + ' (' + friend.login + ')'\r\n  }\r\n\r\n  return (\r\n    <div className=\"mainNavigation mp-bg-light mp-border-secondary mp-shadow-primary\">\r\n      <LeftMenu leftMenu={leftMenu} setLeftMenu={setLeftMenu} />\r\n      <div className=\"flex-wrap nav-menu-back-wrap\">\r\n        {app.mapHidden &&\r\n          <div id=\"backToMain\" className=\"nav-icon\" onClick={backToMain} title={TEXT.toMain}>\r\n            <WoldIcon fill=\"var(--accent)\" />\r\n          </div>\r\n        }\r\n        <div id=\"openLeftMenu\" className=\"nav-icon\" onClick={showLeftMenu} title={TEXT.menu}>\r\n          <Hamburger fill=\"var(--primary)\" />\r\n        </div>\r\n        <Link to=\"/watchMode\">\r\n          <span className=\"mp-dark\">{TEXT.watchMode + ': '} </span><span className=\"mp-counter\">\r\n            {(app.friendModeId ? initials() : TEXT.default)}\r\n          </span>\r\n        </Link>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useDispatch, useSelector } from 'react-redux'\r\nimport { closeModal } from '../store/app'\r\nimport { TEXT } from './lang'\r\n\r\nexport const Modal = () => {\r\n  const data = useSelector(state => state.app.modal)\r\n  const dispatch = useDispatch()\r\n  const acceptLabel = data.acceptLabel !== undefined ? data.acceptLabel : TEXT.acceptDefault\r\n  const cancelLabel = data.cancelLabel !== undefined ? data.cancelLabel : TEXT.cancelDefault\r\n\r\n  async function cancel() {\r\n    await data.cancelAction?.()\r\n    closeModal(dispatch)\r\n  }\r\n  async function accept() {\r\n    await data.acceptAction?.()\r\n    closeModal(dispatch)\r\n  }\r\n\r\n  if (!data) return null;\r\n  return (\r\n    <div className=\"modal-dialog-wrap\">\r\n      <div className=\"modal-dialog mp-border-dark mp-bg-light\">\r\n        <div className=\"modal-dialog-content mp-dark\">\r\n          <div className=\"modal-content\">{data.message}</div>\r\n          {Boolean(data.children) && data.children}\r\n          <div className=\"modal-buttons\">\r\n            {Boolean(cancelLabel) &&\r\n              <button className=\"modal-cancel\" onClick={cancel}>{cancelLabel}</button>}\r\n            {Boolean(acceptLabel) &&\r\n              <button className=\"modal-accept\" onClick={accept}>{acceptLabel}</button>}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect, useState } from \"react\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport { useHistory } from \"react-router-dom\"\r\nimport { logout } from \"../requests/auth\"\r\nimport { updateUser, updateUserPword } from \"../requests/users\"\r\nimport { TEXT } from \"../rest/lang\"\r\nimport { Responser } from \"../rest/Responser\"\r\nimport { hideMain, setToast } from \"../store/app\"\r\nimport { logIntoApp, logOutOfApp } from \"../store/user\"\r\nconst initCreds = { login: '', pword: '', name: '', question: '', answer: '' }\r\n\r\nexport const EditProfile = () => {\r\n  const dispatch = useDispatch()\r\n  const user = useSelector(state => state.user)\r\n  const history = useHistory()\r\n\r\n  const [creds, setCreds] = useState(initCreds)\r\n  const [secretChallenge, setSecretChallenge] = useState(false)\r\n  const [msg, setMsg] = useState('')\r\n\r\n  useEffect(() => {\r\n    if (user.id) setCreds(c => {\r\n      return { ...c, name: user.name, login: user.login, avatar: user.avatar }\r\n    })\r\n    return () => {\r\n      setCreds(initCreds)\r\n    };\r\n  }, [user]);\r\n  \r\n  useEffect(() => {\r\n    hideMain(dispatch)    \r\n    // eslint-disable-next-line\r\n  }, [])\r\n\r\n  function onInput(e) {\r\n    setCreds({ ...creds, [e.target.name]: e.target.value })\r\n  }\r\n\r\n  async function onSubmit(e) {\r\n    e.preventDefault()\r\n\r\n    if (!creds.login || !creds.name) return setMsg(TEXT.fillRequiredFields)\r\n\r\n    // Validation\r\n    if (creds.login.length > 50) return setMsg((TEXT.field + ' ' + TEXT.login + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.pword.length > 50) return setMsg((TEXT.field + ' ' + TEXT.password + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.name.length > 140) return setMsg((TEXT.field + ' ' + TEXT.userName + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n\r\n    // Case pword change call\r\n    if (secretChallenge) {\r\n      const res = await updateUserPword(creds)\r\n      if (res.status === 'OK') {\r\n        setMsg(TEXT.successfulUpdate)\r\n        setSecretChallenge(false)\r\n        return logIntoApp(dispatch, res.data)\r\n      }\r\n      else if (res.status === 'BANEDPWORD') {\r\n        return setMsg(TEXT.bannedPwod + ' - ' + creds.pword)\r\n      }\r\n      return setMsg(TEXT.errCode + ': ' + (res.msg || res))\r\n    }\r\n\r\n    const res = await updateUser(creds)\r\n    console.log('%c⧭', 'color: #514080', res);\r\n\r\n    if (res.status === 'OK') {\r\n      setMsg(TEXT.successfulUpdate)\r\n      return logIntoApp(dispatch, res.data)\r\n    }\r\n    else if (res.status === 'EXISTING') {\r\n      return setMsg(TEXT.loginOccupied + ' - ' + creds.login)\r\n    }\r\n    else if (res.status === 'PWORDCHANGE') {\r\n      setSecretChallenge(true)\r\n      setCreds({ ...creds, question: res.data.question })\r\n      return setMsg(TEXT.secretChallenge)\r\n    }\r\n    else setMsg(TEXT.errCode + ': ' + (res.msg || res))\r\n  }\r\n\r\n  async function logOut() {\r\n    const res = await logout()\r\n    if (res.status === 'OK') {\r\n      setCreds(initCreds)\r\n      setMsg('')\r\n      setToast(dispatch, {\r\n        message: TEXT.farewell + ', ' + user.name,\r\n        status: 'complete',\r\n        title: ''\r\n      })\r\n      logOutOfApp(dispatch)\r\n      return history.push('/')\r\n    }\r\n    setMsg(TEXT.errCode + ': ' + (res.msg || res))\r\n  }\r\n\r\n  return (\r\n    <div className=\"edit-profile-area relative \">\r\n\r\n      <div className=\"edit-profile-wrapper absolute center mp-border-secondary\">\r\n        <form className=\"edit-profile \">\r\n          <h4>{TEXT.editProfile}</h4>\r\n\r\n          <label htmlFor=\"login\">{TEXT.login}:</label>\r\n          <input type=\"text\" name=\"login\" value={creds.login} onInput={onInput} autoFocus required />\r\n          <br />\r\n          <label htmlFor=\"name\">{TEXT.userName}:</label>\r\n          <input type=\"text\" name=\"name\" value={creds.name} onInput={onInput} autoFocus required />\r\n          <br />\r\n          <label htmlFor=\"pword\">{TEXT.password}:</label>\r\n          <input type=\"password\" name=\"pword\" value={creds.pword} onInput={onInput} />\r\n          <br />\r\n          <br />\r\n          {secretChallenge && <>\r\n            <label htmlFor=\"question\">{TEXT.secretQuestion}:</label>\r\n            <br />\r\n            <textarea type=\"text\" name=\"question\" value={creds.question} onInput={onInput} autoComplete=\"false\" readOnly />\r\n            <br />\r\n            <label htmlFor=\"answer\">{TEXT.secterAnswer}:</label>\r\n            <input type=\"text\" name=\"answer\" value={creds.answer} onInput={onInput} required={Boolean(creds.question)} autoComplete=\"false\" />\r\n            <br />\r\n          </>}\r\n          <Responser message={msg} setMessage={setMsg} />\r\n\r\n        </form>\r\n\r\n        <hr className=\"mp-border-secondary\" />\r\n        <div className=\"logout-container\">\r\n          <button className=\"mp-border-secondary profile-logout\" onClick={logOut}>{TEXT.logout}</button>\r\n          <button className=\"mp-border-accent\" onClick={onSubmit}>{TEXT.submit}</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { useDispatch } from 'react-redux';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { registerGUser } from '../requests/users';\r\nimport { googleCreds } from '../rest/config';\r\nimport { TEXT } from '../rest/lang';\r\nimport { Responser } from '../rest/Responser';\r\nimport { logIntoApp } from '../store/user';\r\n\r\n\r\nexport const GoogleConfirm = () => {\r\n  const dispatch = useDispatch()\r\n  const history = useHistory()\r\n\r\n\r\n  const [creds, setCreds] = useState({\r\n    ...googleCreds\r\n  })\r\n  const [msg, setMsg] = useState('')\r\n\r\n\r\n  function onInput(e) {\r\n    setCreds({ ...creds, [e.target.name]: e.target.value })\r\n  }\r\n\r\n  useEffect(() => {\r\n    setCreds(googleCreds)\r\n  }, [])\r\n\r\n  async function onSubmit() {\r\n    // validation\r\n    if (creds.login.length > 50) return setMsg((TEXT.field + ' ' + TEXT.login + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.name.length > 140) return setMsg((TEXT.field + ' ' + TEXT.userName + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n\r\n    const data = { ...creds }\r\n    delete data.occupiedLogin\r\n\r\n    const res = await registerGUser(data)\r\n    console.log('%c⧭', 'color: #0088cc', res);\r\n    if (res.status === 'OK') {\r\n      setMsg(TEXT.successfullReg)\r\n      logIntoApp(dispatch, res.data)\r\n      console.log('%c⧭', 'color: #00b300', googleCreds);\r\n      Object.keys(googleCreds).forEach(key => {\r\n        googleCreds.key = null        \r\n      })\r\n      setCreds(googleCreds)\r\n      history.push('/')\r\n    }\r\n    else if (res.status === 'EXISTING') {\r\n      return setMsg(TEXT.loginOccupied + ' - ' + creds.login)\r\n    }\r\n    else if (res.status === 'BANEDPWORD') {\r\n      return setMsg(TEXT.bannedPwod + ' - ' + creds.pword)\r\n    }\r\n    else {\r\n      setMsg(TEXT.errorReg + ', ' + TEXT.errCode + ': ' + (res.msg || res))\r\n    }\r\n\r\n  }\r\n\r\n  return (\r\n    <div className=\"auth-container relative\">\r\n      <div className=\"absolute center auth-subcontainer\">\r\n        <div className=\"google-regform mp-border-secondary\">\r\n          <h4>{TEXT.oauthTitle}</h4>\r\n          <label htmlFor=\"login\">{TEXT.login}:</label>\r\n          <input type=\"text\" name=\"login\" value={creds.login} onInput={onInput} required />\r\n          {googleCreds.occupiedLogin &&\r\n            <p className=\"little-hint\">{TEXT.login + ' ' + googleCreds.occupiedLogin + ' ' + TEXT.occupied}</p>\r\n          }\r\n          <br />\r\n          <label htmlFor=\"name\">{TEXT.userName}:</label>\r\n          <input type=\"text\" name=\"name\" value={creds.name} onInput={onInput} required />\r\n          <br />\r\n\r\n          <Responser message={msg} setMessage={setMsg} />\r\n\r\n          <button className=\"mp-border-accent\" type=\"button\" onClick={onSubmit}>{TEXT.confirm}</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { closeToast } from '../store/app'\r\nimport { TEXT } from './lang'\r\n\r\nexport const Toast = () => {\r\n  const data = useSelector(state => state.app.toast)\r\n  const dispatch = useDispatch()\r\n  const [visibility, setVisibility] = useState(null)\r\n  const ref = useRef(null)\r\n\r\n\r\n  useEffect(() => {\r\n    const t = setTimeout(() => {\r\n      setVisibility('opaque')\r\n    }, 4000);\r\n    if (ref?.current) ref.current.onmouseover = e => setVisibility(null)\r\n    return () => {\r\n      clearTimeout(t)\r\n    }\r\n  }, [])\r\n\r\n\r\n  function onClick() {\r\n    if (data.clickAction) data.clickAction()\r\n    closeToast(dispatch)\r\n  }\r\n\r\n  if (!data.message) return null\r\n\r\n  // Coloring\r\n  // default status = 'error'\r\n  let main = 'accent'\r\n  let info = 'dark'\r\n  let bg = 'light'\r\n  let border = 'accent'\r\n  let title = data.title !== undefined ? data.title : TEXT.error\r\n  if (data.status === 'info') {\r\n    main = 'counter'\r\n    info = 'dark'\r\n    bg = 'light'\r\n    border = 'counter'\r\n    title = ''\r\n  }\r\n  else if (data.status === 'warning') {\r\n    main = 'counter'\r\n    info = 'accent'\r\n    bg = 'light'\r\n    border = 'accent'\r\n    title = data.title !== undefined ? data.title : TEXT.warning + '!'\r\n  }\r\n  else if (data.status === 'complete') {\r\n    main = 'counter'\r\n    info = 'dark'\r\n    bg = 'light'\r\n    border = 'counter'\r\n    title = data.title !== undefined ? data.title : TEXT.complete + '!'\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={`mp-toast mp-${main} mp-bg-${bg} mp-border-${border} cursor-pointer ${visibility}`}\r\n      onClick={onClick} ref={ref}\r\n      key={data.key}\r\n    >\r\n      <div className=\"toast-header\">\r\n        {title ? <>\r\n          <h6>{title}</h6>\r\n          <div className={`close-cross mp-${info}`}>&#10006;</div>\r\n        </> :\r\n          <>\r\n            <p className={`mp-${info}`}>{data.message}</p>\r\n            <div className={`close-cross mp-${main}`}>&#10006;</div>\r\n          </>\r\n        }\r\n      </div>\r\n      {Boolean(title) && <div className={`toast-contetnt mp-${info}`}>\r\n        {data.message}\r\n      </div>}\r\n      <div className=\"toast-bottom\"></div>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { useHistory, useLocation } from 'react-router-dom'\r\nimport { logout } from '../requests/auth'\r\nimport { registerUser } from '../requests/users'\r\nimport { TEXT } from '../rest/lang'\r\nimport { Responser } from '../rest/Responser'\r\nimport { logIntoApp, logOutOfApp } from '../store/user'\r\nconst initCreds = { login: '', pword: '', name: '', question: TEXT.secretExample, answer: '' }\r\n\r\nexport const AlphaReg = () => {\r\n  const dispatch = useDispatch()\r\n  const history = useHistory()\r\n  const user = useSelector(state => state.user)\r\n  const { search } = useLocation();\r\n\r\n  const [creds, setCreds] = useState(initCreds)\r\n  const [msg, setMsg] = useState('')\r\n  const ref = useRef(null)\r\n  const [replica, setReplica] = useState(false);\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      if (user.id) {\r\n        const res = await logout()\r\n        res.status === 'OK' ? logOutOfApp(dispatch) : setMsg('Ошибка сети')\r\n      }\r\n      const query = new URLSearchParams(search);\r\n      // eslint-disable-next-line \r\n      setCreds({\r\n        ...creds,\r\n        login: query.get('login'),\r\n        name: query.get('name'),\r\n        level: query.get('level')\r\n      })\r\n    })()\r\n\r\n    return () => {\r\n      setCreds(initCreds)\r\n    }\r\n    // eslint-disable-next-line \r\n  }, [])\r\n\r\n  function onInput(e) {\r\n    setCreds({ ...creds, [e.target.name]: e.target.value })\r\n  }\r\n  function onReplica() {\r\n    setReplica(false)\r\n    setMsg(TEXT.secretReplica2)\r\n    ref.current.focus()\r\n  }\r\n\r\n  async function onSubmit() {\r\n    if (!creds.login) return setMsg(TEXT.fillRequiredFields)\r\n    if (creds.question && !creds.answer) {\r\n      if (creds.question === TEXT.secretExample) setReplica(true)\r\n      ref.current.focus()\r\n      return setMsg(TEXT.secretValidation)\r\n    }\r\n\r\n    // Validation\r\n    if (creds.question?.length > 300) return setMsg((TEXT.field + ' ' + TEXT.secretQuestion + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.answer?.length > 255) return setMsg((TEXT.field + ' ' + TEXT.secterAnswer + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.login.length > 50) return setMsg((TEXT.field + ' ' + TEXT.login + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n    if (creds.name.length > 140) return setMsg((TEXT.field + ' ' + TEXT.userName + ' ' + TEXT.tooLong).toLocaleLowerCase().capitalize())\r\n\r\n\r\n    const res = await registerUser(creds)\r\n    if (res.status === 'OK') {\r\n      setMsg(TEXT.successfullReg)\r\n      // await loginWithCreds({ login: creds.login, pword: creds.pword })\r\n      logIntoApp(dispatch, res.data)\r\n      setCreds(initCreds)\r\n      history.push('/')\r\n    }\r\n    else if (res.status === 'EXISTING') {\r\n      return setMsg(TEXT.loginOccupied + ' - ' + creds.login)\r\n    }\r\n    else if (res.status === 'BANEDPWORD') {\r\n      return setMsg(TEXT.bannedPwod + ' - ' + creds.pword)\r\n    }\r\n    else {\r\n      setMsg(TEXT.errorReg + ', ' + TEXT.errCode + ': ' + (res.msg || res))\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"auth-container relative\">\r\n      <div className=\"absolute center auth-subcontainer\">\r\n        <div className=\"auth-action-wrap mp-border-secondary\">\r\n          <div className=\"register-form\">\r\n            <h4>Регистрация по ссылке, без смс</h4>\r\n            <label htmlFor=\"login\">{TEXT.login}:</label>\r\n            <input type=\"text\" name=\"login\" value={creds.login} onInput={onInput} autoFocus required />\r\n            <br />\r\n            <label htmlFor=\"name\">{TEXT.userName}:</label>\r\n            <input type=\"text\" name=\"name\" value={creds.name} onInput={onInput} required />\r\n            <br />\r\n            <label htmlFor=\"pword\">{TEXT.password}:</label>\r\n            <input type=\"password\" placeholder=\"пароль не обязателен\" name=\"pword\" value={creds.pword} onInput={onInput} required />\r\n            <br />\r\n            <br />\r\n            <label htmlFor=\"question\">{TEXT.secretQuestion}:</label>\r\n            <br />\r\n            <textarea type=\"text\" name=\"question\" value={creds.question} onInput={onInput} autoComplete=\"false\" />\r\n            <p className=\"little-hint\">{TEXT.secretHint}</p>\r\n\r\n            <label htmlFor=\"answer\">{TEXT.secterAnswer}:</label>\r\n            <input type=\"text\" name=\"answer\" value={creds.answer} onInput={onInput} required={Boolean(creds.question)} ref={ref} autoComplete=\"false\" />\r\n            <div className=\"register-responser\">\r\n              <Responser message={msg} setMessage={setMsg} />\r\n            </div>\r\n            {replica &&\r\n              <button className=\"btn-replica mp-border-counter mp-primary-hover\" onClick={onReplica}>{TEXT.secretReplica}</button>}\r\n            <button className=\"mp-border-accent\" type=\"button\" onClick={onSubmit}>{TEXT.submit}</button>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useSelector } from \"react-redux\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { TEXT } from \"../rest/lang\";\r\nconst link = window.location.origin + '/friends/addByLink?id='\r\n\r\nexport const DefaultLayout = () => {\r\n  const history = useHistory()\r\n  const { id: userID, friends, requests } = useSelector(s => s.user)\r\n\r\n\r\n  function onClick(id) {\r\n    history.push(`/friends/user/${id}`)\r\n  }\r\n  function onLink(e) {\r\n    e.target.select()\r\n  }\r\n\r\n\r\n  return (\r\n    <div className=\"friendsDefault\">\r\n      {/* <h3>myFriends + addMeLink + addByLink</h3> */}\r\n      {/* My friends */}\r\n      <h4>{TEXT.friendList}</h4>\r\n      <div className=\"friendList\">\r\n        {Boolean(friends?.length) ? friends.map(user => {\r\n          return (\r\n            <div className=\"friendContainer\" key={user.id1 + user.id2}>\r\n              <div className=\"resultUser cursor-pointer mp-accent-hover transition-small\"\r\n                key={user.id} onClick={() => onClick(user.id)}\r\n              >\r\n\r\n                <div className=\"authorLogo mp-bg-secondary\">\r\n                  <span className=\"mp-dark\" title={user.login}>{String(user.name)?.[0]?.toUpperCase()}</span>\r\n                </div>\r\n\r\n                <div className=\"resultUser-creds\">\r\n                  <p className=\"mp-secondary\">{user.name}</p>\r\n                  <label className=\"cursor-pointer\">({user.login})</label>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )\r\n        }) :\r\n          <div className=\"noFriendsCase\">\r\n            <h5>{TEXT.sadlyNoFriends}</h5>\r\n            {/* <button>{TEXT.addFriends}</button> */}\r\n          </div>}\r\n      </div>\r\n      {/* My requests */}\r\n      <h4>{Boolean(requests?.length) && TEXT.friendRequests}</h4>{\r\n        Boolean(requests?.length) &&\r\n        <div className=\"friendList\">\r\n          {Boolean(requests?.length) && requests.map(user => {\r\n            return (\r\n              <div className=\"friendContainer\" key={user.id1 + user.id2}>\r\n                <div className=\"resultUser cursor-pointer mp-accent-hover transition-small\"\r\n                  key={user.id} onClick={() => onClick(user.id)}\r\n                >\r\n\r\n                  <div className=\"authorLogo mp-bg-secondary\">\r\n                    <span className=\"mp-dark\" title={user.login}>{String(user.name)?.[0]?.toUpperCase()}</span>\r\n                  </div>\r\n\r\n                  <div className=\"resultUser-creds\">\r\n                    <p className=\"mp-secondary\">{user.name}</p>\r\n                    <label className=\"cursor-pointer\">({user.login})</label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )\r\n          })}\r\n        </div>}\r\n\r\n      {/* Add me link */}\r\n      <div className=\"addMeLink\">\r\n        <h4>{TEXT.addMeLink}</h4>\r\n        <input type=\"text\" value={link + userID} onFocus={onLink} readOnly />\r\n      </div>\r\n      {/* Add by link */}\r\n      <Link to=\"/friends/addByLink\">\r\n        <button className=\"button\">{TEXT.addByLink}</button>\r\n      </Link>\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\n","export const Loading = ({ loading }) => {\r\n\r\n  if (loading) return (\r\n    <div>\r\n      Loading anmation...\r\n    </div>\r\n  )\r\n\r\n  return null\r\n}\r\n","import { useState } from 'react';\r\nimport { useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Link, useParams } from 'react-router-dom';\r\nimport { getProfileDetails, addFriend as addFriendReq, acceptRequest, removeFriend as removeFriendReq } from '../requests/friends';\r\nimport { TEXT } from '../rest/lang';\r\nimport { Loading } from '../rest/Loading';\r\nimport { setToast } from '../store/app';\r\n\r\nexport const Profile = () => {\r\n  const { userId } = useParams();\r\n  const dispatch = useDispatch()\r\n  const curUser = useSelector(store => store.user)\r\n\r\n  const [user, setUser] = useState(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [friendButton, setFriendButton] = useState(\r\n    // user.friendStatus === 'init'\r\n    <button className=\"button\" onClick={addFriend}>{TEXT.addFriend}</button>\r\n  )\r\n\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n\r\n      // Case it's client wathing hos profile\r\n      if (curUser.id === userId) {\r\n        setUser({ ...curUser })\r\n        setFriendButton(\r\n          <Link to=\"/editProfile\"><button className=\"button\">{TEXT.profile}</button></Link>\r\n        )\r\n        return setLoading(false)\r\n      }\r\n\r\n      const res = await getProfileDetails(userId)\r\n\r\n      if (res.status !== 'OK') setToast(dispatch, { message: TEXT.requestError })\r\n      else setUser(res.data)\r\n      setLoading(false)\r\n    })()\r\n    // eslint-disable-next-line \r\n  }, [userId])\r\n\r\n  useEffect(() => {\r\n    if (!user?.friendStatus) { }\r\n    // Friend statuses\r\n    else if (user.friendStatus === 'friends') setFriendButton(\r\n      <div>\r\n        <Link to=\"/friends\">\r\n          <button className=\"button\" >{TEXT.inFriendlist}</button>\r\n        </Link>\r\n        <button className=\"button mp-border-counter\" onClick={removeFriend}>{TEXT.removeFriend}</button>\r\n      </div>\r\n    )\r\n    else if (user.friendStatus === 'youRequested') setFriendButton(\r\n      <button className=\"button mp-border-secondary mp-secondary\" >{TEXT.youRequested}</button>\r\n    )\r\n    else if (user.friendStatus === 'youAsked') setFriendButton(\r\n      <button className=\"button mp-border-accent\" onClick={confirmRequest}>{TEXT.confirmRequest}</button>\r\n    )\r\n    // eslint-disable-next-line\r\n  }, [user?.friendStatus]);\r\n\r\n  if (loading) return (\r\n    <div className=\"profileContainer\">\r\n      <Loading loading={loading} />\r\n    </div>\r\n  )\r\n\r\n  async function addFriend() {\r\n    const res = await addFriendReq(userId)\r\n    if (res.status !== 'OK') return setToast(dispatch, { message: TEXT.requestError });\r\n    setFriendButton(\r\n      <button className=\"button\">{TEXT.sent}</button>\r\n    )\r\n  }\r\n\r\n  async function removeFriend() {\r\n    const res = await removeFriendReq(userId)\r\n    if (res.status !== 'OK') return setToast(dispatch, { message: TEXT.requestError });\r\n    setUser({ ...user, friendStatus: 'youAsked' })\r\n  }\r\n\r\n  async function confirmRequest() {\r\n    const res = await acceptRequest(userId)\r\n    if (res.status !== 'OK') return setToast(dispatch, { message: TEXT.requestError });\r\n    setUser({ ...user, friendStatus: 'friends' })\r\n  }\r\n\r\n  if (!user) return (\r\n    <div className=\"profileContainer\">\r\n      <div className=\"userProfile mp-border-dark\">\r\n        <p>{TEXT.noResults}</p>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <div className=\"profileContainer\">\r\n      <div className=\"userProfile mp-border-dark\">\r\n        {Boolean(user.avatar) && <div className=\"avatar\"><img src={user.avatar} alt={TEXT.avatar} /></div>}\r\n        <div className=\"mp-primary credentials \" title={TEXT.userName}>{user.name} <label\r\n          className=\"mp-dark\" title={TEXT.login}>({user.login})\r\n        </label>\r\n        </div>\r\n        {Boolean(user.commentsn + 1) && <div className=\"commentsn\">{TEXT.commentsn}: {user.commentsn}</div>}\r\n        <div className=\"level capitalize\">{TEXT.level}: <label className=\"mp-dark\">{user.level}</label></div>\r\n      </div>\r\n      <div className=\"friends-actionButton\">\r\n        {\r\n          friendButton\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useHistory, useLocation } from \"react-router-dom\"\r\nimport { TEXT } from \"../rest/lang\";\r\n\r\nexport const Results = ({ searchResults }) => {\r\n  const query = new URLSearchParams(useLocation().search).get('query')\r\n  const history = useHistory()\r\n\r\n  if (!searchResults) return null\r\n\r\n  if (!searchResults.length) return (\r\n    <div className=\"resultsContainer\">\r\n      <h5>{TEXT.noResults}</h5>\r\n    </div>\r\n  )\r\n\r\n  function onClick(id) {\r\n    history.push(`/friends/user/${id}?from=${query}`)\r\n  }\r\n\r\n  return (\r\n    <div className=\"resultsContainer\">\r\n      {searchResults.map(user => {\r\n        return (\r\n          <div className=\"resultUser cursor-pointer mp-accent-hover transition-small\"\r\n            key={user.id} onClick={() => onClick(user.id)}\r\n          >\r\n\r\n            <div className=\"authorLogo mp-bg-secondary\">\r\n              <span className=\"mp-dark\" title={user.login}>{String(user.name)?.[0]?.toUpperCase()}</span>\r\n            </div>\r\n\r\n            <div className=\"resultUser-creds\">\r\n              <p className=\"mp-secondary\">{user.name}</p>\r\n              <label className=\"cursor-pointer\">({user.login})</label>\r\n            </div>\r\n          </div>\r\n        )\r\n      })}\r\n    </div>\r\n  )\r\n}\r\n","import { useState } from \"react\"\r\nimport { useDispatch } from \"react-redux\"\r\nimport { useHistory } from \"react-router-dom\"\r\nimport { searchUsers } from \"../requests/friends\"\r\nimport { TEXT } from \"../rest/lang\"\r\nimport { setToast } from \"../store/app\"\r\n\r\nexport const SearchBar = ({ setSearchResults }) => {\r\n  const dispatch = useDispatch()\r\n  const history = useHistory()\r\n\r\n  const [input, setInput] = useState('')\r\n\r\n\r\n  function onInput(e) {\r\n    setInput(e.target.value)\r\n  }\r\n\r\n  async function submitEnter() {\r\n    const res = await searchUsers(input)\r\n    if (res.status !== 'OK') return setToast(dispatch, { message: TEXT.requestError });\r\n    setSearchResults(res.data)\r\n    history.push('/friends/search?query=' + input)\r\n  }\r\n\r\n  function onKeyDown(e) {\r\n    if (e.key !== 'Enter') return;\r\n    submitEnter()\r\n  }\r\n\r\n  function onBack() {\r\n    history.goBack()\r\n  }\r\n\r\n  return (\r\n    <div className=\"searchContainer transition\">\r\n\r\n      <div onClick={onBack} className=\"backButton\">\r\n        <button className=\"button mp-primary\">{\"<<\"}</button>\r\n      </div>\r\n\r\n      <label htmlFor=\"search\"></label>\r\n      <input type=\"text\" name=\"search\" value={input} onInput={onInput} onKeyDown={onKeyDown} />\r\n      <button onClick={submitEnter}>searchPH</button>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect } from 'react'\r\nimport { useState } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { Link, useLocation } from 'react-router-dom'\r\nimport { addByLink } from '../requests/friends'\r\nimport { TEXT } from '../rest/lang'\r\nimport { Loading } from '../rest/Loading'\r\nimport { setToast } from '../store/app'\r\n\r\nexport const AddByLink = () => {\r\n  const paramId = new URLSearchParams(useLocation().search).get('id')\r\n  const dispatch = useDispatch()\r\n\r\n  const [id, setId] = useState(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [link, setLink] = useState('')\r\n  function onInput(e) {\r\n    const val = e.target.value\r\n    setLink(val)\r\n    if (val?.includes('id')) {\r\n      const q = new URLSearchParams(val.split('?')[1])\r\n      if (q.get('id')) setId(q.get('id'))\r\n    }\r\n  }\r\n  const [readOnly, setReadOnly] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (paramId) setId(paramId)\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      if (!id) return;\r\n\r\n      console.log('%c⧭ id run', 'color: #733d00', id);\r\n\r\n      await addFriend()\r\n      setLoading(false)\r\n    })()\r\n    // eslint-disable-next-line\r\n  }, [id]);\r\n\r\n  async function addFriend() {\r\n    const res = await addByLink(id)\r\n    console.log('%c⧭', 'color: #00e600', res);\r\n    if (res.status !== 'OK') return setToast(dispatch, { message: TEXT.requestError });\r\n    setToast(dispatch, { message: TEXT.yourFriendsNow, status: 'complete' })\r\n    setReadOnly(true)\r\n  }\r\n\r\n  if (paramId && loading) return (\r\n    <Loading loading={loading} />\r\n  )\r\n\r\n  return (\r\n    <div className=\"addByLink\">\r\n      <h4>{TEXT.addByLink}</h4>\r\n      {!readOnly ?\r\n        <div className=\"field\">\r\n          <label htmlFor=\"link\">{TEXT.pasteAddLink}</label>\r\n          <input type=\"text\" value={link} onInput={onInput} readOnly={readOnly} />\r\n        </div> :\r\n        <div>\r\n          <Link to=\"/friends\">\r\n            <button className=\"button\">{TEXT.goBack}</button>\r\n          </Link>\r\n        </div>}\r\n    </div>\r\n  )\r\n}\r\n","import { useState } from \"react\";\r\nimport { Link, Route, Switch } from \"react-router-dom\"\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { DefaultLayout } from \"./DefaultLayout\";\r\nimport { Profile } from \"./Profile\";\r\nimport { Results } from \"./Results\";\r\nimport { SearchBar } from \"./SearchBar\";\r\nimport \"./Friends.css\"\r\nimport { useEffect } from \"react\";\r\nimport { hideMain } from \"../store/app\";\r\nimport { TEXT } from \"../rest/lang\";\r\nimport { AddByLink } from \"./AddByLink\";\r\n\r\n\r\nexport const FriendsMain = () => {\r\n  const dispatch = useDispatch()\r\n  const app = useSelector(state => state.app)\r\n\r\n  const [searchResults, setSearchResults] = useState(null);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    hideMain(dispatch)\r\n    // eslint-disable-next-line\r\n  }, [])\r\n\r\n  if (!app.isLogged) {\r\n    return (\r\n      // Styles from /Auth/Auth.css\r\n      <div className=\"friendsNotLoggedWrap auth-container relative\">\r\n        <div className=\"absolute center auth-subcontainer\">\r\n          <div className=\"auth-action-wrap mp-border-secondary\">\r\n            <p>{TEXT.loginToUseThis}</p>\r\n            <Link to=\"/auth\">\r\n              <button className=\"primary mp-border-accent loginBtn capitalize\">\r\n                {TEXT.authorization}\r\n              </button>\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // <Link to={`${url}/rendering`}>Rendering with React</Link>\r\n  return (\r\n    <div>\r\n      <SearchBar setSearchResults={setSearchResults} />\r\n\r\n      <Switch>\r\n        <Route exact path=\"/friends\">\r\n          <DefaultLayout />\r\n        </Route>\r\n        <Route path=\"/friends/user/:userId\">\r\n          <Profile />\r\n        </Route>\r\n        <Route path=\"/friends/search\">\r\n          <Results searchResults={searchResults} />\r\n        </Route>\r\n        <Route path=\"/friends/addByLink\">\r\n          <AddByLink />\r\n        </Route>\r\n\r\n      </Switch>\r\n    </div>\r\n  )\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport { TEXT } from '../rest/lang'\r\nimport { friendModeId, hideMain } from '../store/app'\r\n\r\nexport const WatchMode = () => {\r\n  const dispatch = useDispatch()\r\n  const history = useHistory()\r\n  const { friends } = useSelector(s => s.user)\r\n\r\n  function onClick(id) {\r\n    history.push('/')\r\n    friendModeId(dispatch, id)\r\n  }\r\n\r\n  function reset() {\r\n    history.push('/')\r\n    friendModeId(dispatch, null)\r\n  }\r\n\r\n  useEffect(() => {\r\n    hideMain(dispatch)\r\n    // eslint-disable-next-line\r\n  }, [])\r\n\r\n  return (\r\n    <div className=\"watchMode\">\r\n\r\n      <h4>{TEXT.watchMode}</h4>\r\n      <p className=\"subtitle\">{TEXT.watchModeSub1}</p>\r\n      <div className=\"friendList\">\r\n        {Boolean(friends?.length) ? friends.map(user => {\r\n          return (\r\n            <div className=\"friendContainer\" key={user.id1 + user.id2}>\r\n              <div className=\"resultUser cursor-pointer mp-accent-hover transition-small\"\r\n                key={user.id} onClick={() => onClick(user.id)}\r\n              >\r\n\r\n                <div className=\"authorLogo mp-bg-secondary\">\r\n                  <span className=\"mp-dark\" title={user.login}>{String(user.name)?.[0]?.toUpperCase()}</span>\r\n                </div>\r\n\r\n                <div className=\"resultUser-creds\">\r\n                  <p className=\"mp-secondary\">{user.name}</p>\r\n                  <label className=\"cursor-pointer\">({user.login})</label>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )\r\n        }) :\r\n          <div className=\"noFriendsCase\">\r\n            <h5>{TEXT.watchModeSub2}</h5>\r\n            <Link to=\"/friends\">\r\n              <button>{TEXT.addFriends}</button>\r\n            </Link>\r\n          </div>}\r\n      </div>\r\n      <button className=\"button capitalize mp-counter mp-border-counter\" onClick={reset}>{TEXT.reset}</button>\r\n    </div>\r\n  )\r\n}\r\n","import {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n} from \"react-router-dom\";\r\n// Components\r\nimport { Main } from \"./Map/Main\";\r\nimport './Map/Maps.css'\r\nimport { AuthMain } from './Auth/AuthMain'\r\nimport { useEffect } from \"react\";\r\n\r\nimport './App.css'\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { NavMain } from \"./navigation/NavMain\";\r\nimport { setModal } from \"./store/app\";\r\nimport { Modal } from \"./rest/Modal\";\r\nimport { EditProfile } from \"./Auth/EditProfile\";\r\nimport { GoogleConfirm } from \"./Auth/GoogleConfirm\";\r\nimport { Toast } from \"./rest/Toast\";\r\nimport { AlphaReg } from \"./Auth/AlphaReg\";\r\nimport { TEXT } from \"./rest/lang\";\r\nimport { Login } from \"./Auth/Login\";\r\nimport { getPreferences, setPreference } from \"./store/localstorage\";\r\nimport { FriendsMain } from \"./Friends/FriendsMain\";\r\nimport { WatchMode } from \"./navigation/WatchMode\";\r\nimport { getFriendsInfo } from \"./rest/helperFuncs\";\r\n\r\n\r\nfunction App() {\r\n  const dispatch = useDispatch()\r\n  const app = useSelector(state => state.app)\r\n  const children =\r\n    <div className=\"auth-modal-containter mp-border-secondary\">\r\n      <Login />\r\n    </div>\r\n\r\n  useEffect(() => {\r\n    if (!app.isLogged && !getPreferences().skipLogin) {\r\n      setModal(dispatch, {\r\n        acceptLabel: null,\r\n        cancelLabel: TEXT.skip,\r\n        cancelAction() {\r\n          setPreference('skipLogin', true)\r\n        },\r\n        message: TEXT.wannaAuthorize,\r\n        children,\r\n      })\r\n    }\r\n    (async function () {\r\n      await getFriendsInfo(dispatch)      \r\n    })()\r\n    /* eslint-disable */\r\n  }, [])\r\n  /* eslint-enable */\r\n\r\n  return (\r\n    <Router >\r\n      <Modal />\r\n      <NavMain />\r\n      {app.toast && <Toast key={app.toast?.key} />}\r\n\r\n      <Main />\r\n\r\n      {/* Extra subpages */}\r\n\r\n      <Switch>\r\n\r\n        <Route path=\"/auth\">\r\n          <div className=\"routeWrapper\">\r\n            <AuthMain />\r\n          </div>\r\n        </Route>\r\n        {/* TODO alpha only */}\r\n        <Route path=\"/alphaReg\">\r\n          <div className=\"routeWrapper\">\r\n            <AlphaReg />\r\n          </div>\r\n        </Route>\r\n\r\n        <Route path=\"/editProfile\">\r\n          <div className=\"routeWrapper\">\r\n            <EditProfile />\r\n          </div>\r\n        </Route>\r\n        <Route path=\"/googleConfirm\">\r\n          <div className=\"routeWrapper\">\r\n            <GoogleConfirm />\r\n          </div>\r\n        </Route>\r\n\r\n        <Route path=\"/friends\">\r\n          <div className=\"routeWrapper\">\r\n            <FriendsMain />\r\n          </div>\r\n        </Route>\r\n\r\n        <Route path=\"/watchMode\">\r\n          <div className=\"routeWrapper\">\r\n            <WatchMode />\r\n          </div>\r\n        </Route>\r\n\r\n      </Switch>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { combineReducers, createStore } from 'redux';\r\nimport { appReducer } from './app';\r\nimport { userReducer } from './user';\r\n\r\n\r\nexport const rootReducer = combineReducers({\r\n  user: userReducer,\r\n  app: appReducer\r\n});\r\n\r\nexport const store = createStore(rootReducer);\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { refresh } from \"../requests/auth\";\r\nimport { initialState as appInitialState } from \"../store/app\";\r\nimport { initialState as userInitialState } from \"../store/user\";\r\nimport { getPreferences, initLocalStorage } from \"../store/localstorage\";\r\nimport { initializeThemeColors, setColors } from \"./colors\"\r\nimport { appThemes } from \"./config\"\r\nimport { TEXT } from \"./lang\";\r\n\r\nexport async function initActions() {\r\n  // Prototypes\r\n  // eslint-disable-next-line\r\n  String.prototype.capitalize = function () {\r\n    return this.charAt(0).toUpperCase() + this.slice(1);\r\n  }\r\n\r\n  initLocalStorage()\r\n\r\n  // Set prefered theme\r\n  let theme = appThemes[0]\r\n  let preferences = getPreferences()\r\n  // console.log('%c⧭', 'color: #bfffc8', preferences);\r\n\r\n  // Rewrite theme if any\r\n  if (preferences.theme && appThemes.indexOf(preferences.theme) > -1) {\r\n    theme = preferences.theme\r\n    appInitialState.theme = preferences.theme\r\n  }\r\n  \r\n  initializeThemeColors()\r\n  document.head.insertAdjacentHTML(\"beforeend\", `<style>:root{}</style>`)\r\n  setColors(theme)\r\n\r\n  // Refresh cookie and info\r\n  const res = await refresh()\r\n  if (res.status === 'OK') {\r\n    if (res.data) {\r\n      Object.entries(res.data).forEach(([key, val]) => userInitialState[key] = val)\r\n      appInitialState.isLogged = true\r\n    }\r\n  }\r\n  else if (res.status === 'REAUTH') {\r\n    return;// do nothing\r\n  }\r\n\r\n  else {\r\n    appInitialState.toast = {\r\n      message: TEXT.initConnectionErr\r\n    }\r\n    return 'connection_error'\r\n  }\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport { store } from './store/root';\nimport { Provider } from 'react-redux'\nimport reportWebVitals from './reportWebVitals';\nimport { initActions } from './rest/beforeApp';\n\n(async function () {\n  // const refresh = \n  await initActions()\n  // if (refresh === 'connection_error')\n\n  ReactDOM.render(\n    <React.StrictMode>\n      <Provider store={store}>\n        <App />\n      </Provider>\n    </React.StrictMode>,\n    document.getElementById('root')\n  );\n}())\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}